nohup: ignoring input
Namespace(batch_size=512, dataset='amazon_beauty', decay_step=100, description='Diffu_norm_score', device='cuda', diffusion_steps=32, diversity_measure=False, dropout=0.1, emb_dropout=0.3, epoch_time_avg=False, epochs=500, eval_interval=20, gamma=0.1, hidden_act='gelu', hidden_size=128, lambda_uncertainty=0.001, log_file='log/', long_head=False, loss_lambda=0.001, lr=0.001, max_len=50, metric_ks=[5, 10, 20], momentum=None, noise_schedule='trunc_lin', num_blocks=4, num_gpu=1, optimizer='Adam', patience=5, random_seed=1997, rescale_timesteps=True, schedule_sampler_name='lossaware', weight_decay=0)
Epoch: 0
[0/257] Loss: 39.3703
[52/257] Loss: 36.7608
[104/257] Loss: 34.3384
[156/257] Loss: 32.4511
[208/257] Loss: 30.1343
loss in epoch 0: 28.073949813842773
Epoch: 1
[0/257] Loss: 27.6860
[52/257] Loss: 25.4343
[104/257] Loss: 23.1268
[156/257] Loss: 16.9159
[208/257] Loss: 13.5822
loss in epoch 1: 11.883866310119629
Epoch: 2
[0/257] Loss: 11.4729
[52/257] Loss: 10.5438
[104/257] Loss: 10.2035
[156/257] Loss: 10.0449
[208/257] Loss: 9.8162
loss in epoch 2: 9.668498992919922
Epoch: 3
[0/257] Loss: 9.8454
[52/257] Loss: 9.7982
[104/257] Loss: 9.5765
[156/257] Loss: 9.6173
[208/257] Loss: 9.5060
loss in epoch 3: 9.499096870422363
Epoch: 4
[0/257] Loss: 9.5036
[52/257] Loss: 9.5040
[104/257] Loss: 9.4193
[156/257] Loss: 9.4475
[208/257] Loss: 9.3955
loss in epoch 4: 9.305740356445312
Epoch: 5
[0/257] Loss: 9.3165
[52/257] Loss: 9.3100
[104/257] Loss: 9.2434
[156/257] Loss: 9.3077
[208/257] Loss: 9.2353
loss in epoch 5: 9.159422874450684
Epoch: 6
[0/257] Loss: 9.1807
[52/257] Loss: 9.1390
[104/257] Loss: 9.0907
[156/257] Loss: 9.1314
[208/257] Loss: 9.0581
loss in epoch 6: 9.0493803024292
Epoch: 7
[0/257] Loss: 9.0028
[52/257] Loss: 9.0543
[104/257] Loss: 9.0625
[156/257] Loss: 9.0086
[208/257] Loss: 9.0340
loss in epoch 7: 9.139959335327148
Epoch: 8
[0/257] Loss: 9.1895
[52/257] Loss: 9.0538
[104/257] Loss: 9.1637
[156/257] Loss: 9.2726
[208/257] Loss: 9.1466
loss in epoch 8: 8.928353309631348
Epoch: 9
[0/257] Loss: 8.9234
[52/257] Loss: 8.9620
[104/257] Loss: 8.9705
[156/257] Loss: 8.9787
[208/257] Loss: 9.0057
loss in epoch 9: 8.853447914123535
Epoch: 10
[0/257] Loss: 8.8738
[52/257] Loss: 8.8647
[104/257] Loss: 8.9456
[156/257] Loss: 8.9320
[208/257] Loss: 8.8839
loss in epoch 10: 8.911128044128418
Epoch: 11
[0/257] Loss: 8.9008
[52/257] Loss: 8.8255
[104/257] Loss: 8.7535
[156/257] Loss: 8.9536
[208/257] Loss: 8.8221
loss in epoch 11: 8.811328887939453
Epoch: 12
[0/257] Loss: 8.9446
[52/257] Loss: 8.8664
[104/257] Loss: 8.8516
[156/257] Loss: 8.8333
[208/257] Loss: 8.8192
loss in epoch 12: 8.881287574768066
Epoch: 13
[0/257] Loss: 8.8704
[52/257] Loss: 8.8079
[104/257] Loss: 8.7968
[156/257] Loss: 8.8232
[208/257] Loss: 8.7561
loss in epoch 13: 8.745980262756348
Epoch: 14
[0/257] Loss: 8.7342
[52/257] Loss: 8.8294
[104/257] Loss: 8.8869
[156/257] Loss: 8.8264
[208/257] Loss: 8.7488
loss in epoch 14: 8.883831024169922
Epoch: 15
[0/257] Loss: 8.8360
[52/257] Loss: 8.7271
[104/257] Loss: 8.9429
[156/257] Loss: 8.8842
[208/257] Loss: 8.8273
loss in epoch 15: 8.830526351928711
Epoch: 16
[0/257] Loss: 8.8530
[52/257] Loss: 8.7136
[104/257] Loss: 8.8463
[156/257] Loss: 8.8442
[208/257] Loss: 8.8687
loss in epoch 16: 8.728446960449219
Epoch: 17
[0/257] Loss: 8.7598
[52/257] Loss: 8.7942
[104/257] Loss: 8.8889
[156/257] Loss: 8.9108
[208/257] Loss: 8.8021
loss in epoch 17: 8.73532772064209
Epoch: 18
[0/257] Loss: 8.8021
[52/257] Loss: 8.7132
[104/257] Loss: 8.8236
[156/257] Loss: 9.0067
[208/257] Loss: 8.7458
loss in epoch 18: 8.77723503112793
Epoch: 19
[0/257] Loss: 8.7582
[52/257] Loss: 8.8267
[104/257] Loss: 8.7793
[156/257] Loss: 8.7509
[208/257] Loss: 8.7118
loss in epoch 19: 8.767142295837402
Epoch: 20
[0/257] Loss: 8.6991
[52/257] Loss: 8.7931
[104/257] Loss: 8.8668
[156/257] Loss: 8.7630
[208/257] Loss: 8.9073
loss in epoch 20: 8.814204216003418
start predicting:  2024-12-06 11:19:59.758776
{'Best_HR@5': 0.8789, 'Best_NDCG@5': 0.5325, 'Best_HR@10': 1.487, 'Best_NDCG@10': 0.7277, 'Best_HR@20': 2.5568, 'Best_NDCG@20': 0.9964}
{'Best_epoch_HR@5': 20, 'Best_epoch_NDCG@5': 20, 'Best_epoch_HR@10': 20, 'Best_epoch_NDCG@10': 20, 'Best_epoch_HR@20': 20, 'Best_epoch_NDCG@20': 20}
Epoch: 21
[0/257] Loss: 8.8523
[52/257] Loss: 8.8317
[104/257] Loss: 8.6899
[156/257] Loss: 8.7929
[208/257] Loss: 8.6925
loss in epoch 21: 8.829297065734863
Epoch: 22
[0/257] Loss: 8.6954
[52/257] Loss: 8.8350
[104/257] Loss: 8.6893
[156/257] Loss: 8.8334
[208/257] Loss: 8.8700
loss in epoch 22: 8.750210762023926
Epoch: 23
[0/257] Loss: 8.7330
[52/257] Loss: 8.7954
[104/257] Loss: 8.8261
[156/257] Loss: 8.7872
[208/257] Loss: 8.7978
loss in epoch 23: 8.85454273223877
Epoch: 24
[0/257] Loss: 8.8743
[52/257] Loss: 8.8157
[104/257] Loss: 8.7988
[156/257] Loss: 8.8340
[208/257] Loss: 8.7474
loss in epoch 24: 8.839977264404297
Epoch: 25
[0/257] Loss: 8.8046
[52/257] Loss: 8.7819
[104/257] Loss: 8.7626
[156/257] Loss: 8.8017
[208/257] Loss: 8.8703
loss in epoch 25: 8.865422248840332
Epoch: 26
[0/257] Loss: 8.8859
[52/257] Loss: 8.8264
[104/257] Loss: 8.7558
[156/257] Loss: 8.7986
[208/257] Loss: 8.8863
loss in epoch 26: 8.835407257080078
Epoch: 27
[0/257] Loss: 8.7653
[52/257] Loss: 8.8250
[104/257] Loss: 8.7901
[156/257] Loss: 8.7713
[208/257] Loss: 8.8158
loss in epoch 27: 8.71549129486084
Epoch: 28
[0/257] Loss: 8.7579
[52/257] Loss: 8.7900
[104/257] Loss: 8.6679
[156/257] Loss: 8.8468
[208/257] Loss: 8.8855
loss in epoch 28: 8.85995101928711
Epoch: 29
[0/257] Loss: 8.7031
[52/257] Loss: 8.8366
[104/257] Loss: 8.7624
[156/257] Loss: 8.8342
[208/257] Loss: 8.7481
loss in epoch 29: 8.739445686340332
Epoch: 30
[0/257] Loss: 8.8124
[52/257] Loss: 8.7720
[104/257] Loss: 8.7606
[156/257] Loss: 8.7893
[208/257] Loss: 8.8904
loss in epoch 30: 8.771764755249023
Epoch: 31
[0/257] Loss: 8.8306
[52/257] Loss: 8.8208
[104/257] Loss: 8.7369
[156/257] Loss: 8.8222
[208/257] Loss: 8.8601
loss in epoch 31: 8.935990333557129
Epoch: 32
[0/257] Loss: 8.7777
[52/257] Loss: 8.7197
[104/257] Loss: 8.8034
[156/257] Loss: 8.8258
[208/257] Loss: 8.7170
loss in epoch 32: 8.785810470581055
Epoch: 33
[0/257] Loss: 8.7280
[52/257] Loss: 8.7921
[104/257] Loss: 8.7436
[156/257] Loss: 8.8634
[208/257] Loss: 8.8226
loss in epoch 33: 8.855008125305176
Epoch: 34
[0/257] Loss: 8.7916
[52/257] Loss: 8.7556
[104/257] Loss: 8.8285
[156/257] Loss: 8.8483
[208/257] Loss: 8.8033
loss in epoch 34: 8.788164138793945
Epoch: 35
[0/257] Loss: 8.8014
[52/257] Loss: 8.8149
[104/257] Loss: 8.7882
[156/257] Loss: 8.7907
[208/257] Loss: 8.8052
loss in epoch 35: 8.860902786254883
Epoch: 36
[0/257] Loss: 8.6955
[52/257] Loss: 8.7012
[104/257] Loss: 8.7899
[156/257] Loss: 8.8095
[208/257] Loss: 8.8894
loss in epoch 36: 8.764471054077148
Epoch: 37
[0/257] Loss: 8.8286
[52/257] Loss: 8.8525
[104/257] Loss: 8.7832
[156/257] Loss: 8.8657
[208/257] Loss: 8.8533
loss in epoch 37: 8.712713241577148
Epoch: 38
[0/257] Loss: 8.8213
[52/257] Loss: 8.7660
[104/257] Loss: 8.8098
[156/257] Loss: 8.7522
[208/257] Loss: 8.7871
loss in epoch 38: 8.71957015991211
Epoch: 39
[0/257] Loss: 8.7052
[52/257] Loss: 8.8218
[104/257] Loss: 8.8353
[156/257] Loss: 8.8424
[208/257] Loss: 8.7787
loss in epoch 39: 8.853546142578125
Epoch: 40
[0/257] Loss: 8.7689
[52/257] Loss: 8.7404
[104/257] Loss: 8.8194
[156/257] Loss: 8.7441
[208/257] Loss: 8.7146
loss in epoch 40: 8.778836250305176
start predicting:  2024-12-06 11:30:54.747418
Epoch: 41
[0/257] Loss: 8.7457
[52/257] Loss: 8.7961
[104/257] Loss: 8.8271
[156/257] Loss: 8.8369
[208/257] Loss: 8.8883
loss in epoch 41: 8.717382431030273
Epoch: 42
[0/257] Loss: 8.7103
[52/257] Loss: 8.7192
[104/257] Loss: 8.8319
[156/257] Loss: 8.8390
[208/257] Loss: 8.8501
loss in epoch 42: 8.838972091674805
Epoch: 43
[0/257] Loss: 8.7887
[52/257] Loss: 8.7610
[104/257] Loss: 8.7504
[156/257] Loss: 8.8053
[208/257] Loss: 8.7354
loss in epoch 43: 8.74155330657959
Epoch: 44
[0/257] Loss: 8.7143
[52/257] Loss: 8.8066
[104/257] Loss: 8.6942
[156/257] Loss: 8.8190
[208/257] Loss: 8.7936
loss in epoch 44: 8.786130905151367
Epoch: 45
[0/257] Loss: 8.7884
[52/257] Loss: 8.8608
[104/257] Loss: 8.7658
[156/257] Loss: 8.7750
[208/257] Loss: 8.7955
loss in epoch 45: 8.856518745422363
Epoch: 46
[0/257] Loss: 8.7212
[52/257] Loss: 8.7748
[104/257] Loss: 8.7818
[156/257] Loss: 8.8435
[208/257] Loss: 8.7656
loss in epoch 46: 8.765043258666992
Epoch: 47
[0/257] Loss: 8.7975
[52/257] Loss: 8.7638
[104/257] Loss: 8.8904
[156/257] Loss: 8.7910
[208/257] Loss: 8.8160
loss in epoch 47: 8.817093849182129
Epoch: 48
[0/257] Loss: 8.6990
[52/257] Loss: 8.8161
[104/257] Loss: 8.7715
[156/257] Loss: 8.8085
[208/257] Loss: 8.7818
loss in epoch 48: 8.87653923034668
Epoch: 49
[0/257] Loss: 8.8117
[52/257] Loss: 8.7815
[104/257] Loss: 8.7422
[156/257] Loss: 8.7008
[208/257] Loss: 8.8179
loss in epoch 49: 8.879444122314453
Epoch: 50
[0/257] Loss: 8.8247
[52/257] Loss: 8.7288
[104/257] Loss: 8.8542
[156/257] Loss: 8.7887
[208/257] Loss: 8.8278
loss in epoch 50: 8.789180755615234
Epoch: 51
[0/257] Loss: 8.7599
[52/257] Loss: 8.8299
[104/257] Loss: 8.7534
[156/257] Loss: 8.8118
[208/257] Loss: 8.7820
loss in epoch 51: 8.936097145080566
Epoch: 52
[0/257] Loss: 8.7717
[52/257] Loss: 8.8096
[104/257] Loss: 8.7383
[156/257] Loss: 8.7792
[208/257] Loss: 8.8298
loss in epoch 52: 8.792197227478027
Epoch: 53
[0/257] Loss: 8.8559
[52/257] Loss: 8.8324
[104/257] Loss: 8.7853
[156/257] Loss: 8.7993
[208/257] Loss: 8.8542
loss in epoch 53: 8.905381202697754
Epoch: 54
[0/257] Loss: 8.7730
[52/257] Loss: 8.7449
[104/257] Loss: 8.8304
[156/257] Loss: 8.8098
[208/257] Loss: 8.8198
loss in epoch 54: 8.847081184387207
Epoch: 55
[0/257] Loss: 8.7729
[52/257] Loss: 8.7644
[104/257] Loss: 8.8484
[156/257] Loss: 8.8343
[208/257] Loss: 8.7259
loss in epoch 55: 8.81559944152832
Epoch: 56
[0/257] Loss: 8.6965
[52/257] Loss: 8.6796
[104/257] Loss: 8.6346
[156/257] Loss: 8.7472
[208/257] Loss: 8.8946
loss in epoch 56: 8.717568397521973
Epoch: 57
[0/257] Loss: 8.7688
[52/257] Loss: 8.8460
[104/257] Loss: 8.8170
[156/257] Loss: 8.7882
[208/257] Loss: 8.7534
loss in epoch 57: 8.751005172729492
Epoch: 58
[0/257] Loss: 8.6806
[52/257] Loss: 8.7579
[104/257] Loss: 8.7426
[156/257] Loss: 8.7482
[208/257] Loss: 8.7118
loss in epoch 58: 8.78129768371582
Epoch: 59
[0/257] Loss: 8.7243
[52/257] Loss: 8.7006
[104/257] Loss: 8.8115
[156/257] Loss: 8.5894
[208/257] Loss: 8.6972
loss in epoch 59: 8.665081024169922
Epoch: 60
[0/257] Loss: 8.6764
[52/257] Loss: 8.6791
[104/257] Loss: 8.6865
[156/257] Loss: 8.8036
[208/257] Loss: 8.7612
loss in epoch 60: 8.69378662109375
start predicting:  2024-12-06 11:41:48.938674
{'Best_HR@5': 0.8789, 'Best_NDCG@5': 0.5325, 'Best_HR@10': 1.5669, 'Best_NDCG@10': 0.748, 'Best_HR@20': 2.5568, 'Best_NDCG@20': 0.9964}
{'Best_epoch_HR@5': 20, 'Best_epoch_NDCG@5': 20, 'Best_epoch_HR@10': 60, 'Best_epoch_NDCG@10': 60, 'Best_epoch_HR@20': 20, 'Best_epoch_NDCG@20': 20}
Epoch: 61
[0/257] Loss: 8.6714
[52/257] Loss: 8.6777
[104/257] Loss: 8.8204
[156/257] Loss: 8.6999
[208/257] Loss: 8.6563
loss in epoch 61: 8.716653823852539
Epoch: 62
[0/257] Loss: 8.7267
[52/257] Loss: 8.7095
[104/257] Loss: 8.8089
[156/257] Loss: 8.5409
[208/257] Loss: 8.6928
loss in epoch 62: 8.688814163208008
Epoch: 63
[0/257] Loss: 8.6390
[52/257] Loss: 8.7382
[104/257] Loss: 8.7390
[156/257] Loss: 8.6638
[208/257] Loss: 8.6997
loss in epoch 63: 8.656975746154785
Epoch: 64
[0/257] Loss: 8.6971
[52/257] Loss: 8.7093
[104/257] Loss: 8.7099
[156/257] Loss: 8.6973
[208/257] Loss: 8.6766
loss in epoch 64: 8.664505958557129
Epoch: 65
[0/257] Loss: 8.5575
[52/257] Loss: 8.7082
[104/257] Loss: 8.7125
[156/257] Loss: 8.6292
[208/257] Loss: 8.6303
loss in epoch 65: 8.783669471740723
Epoch: 66
[0/257] Loss: 8.6742
[52/257] Loss: 8.6372
[104/257] Loss: 8.7362
[156/257] Loss: 8.8222
[208/257] Loss: 8.6893
loss in epoch 66: 8.676671981811523
Epoch: 67
[0/257] Loss: 8.6157
[52/257] Loss: 8.7602
[104/257] Loss: 8.5779
[156/257] Loss: 8.5958
[208/257] Loss: 8.6525
loss in epoch 67: 8.538153648376465
Epoch: 68
[0/257] Loss: 8.6223
[52/257] Loss: 8.7075
[104/257] Loss: 8.6562
[156/257] Loss: 8.6624
[208/257] Loss: 8.6920
loss in epoch 68: 8.575797080993652
Epoch: 69
[0/257] Loss: 8.6913
[52/257] Loss: 8.6470
[104/257] Loss: 8.6980
[156/257] Loss: 8.7705
[208/257] Loss: 8.6403
loss in epoch 69: 8.663749694824219
Epoch: 70
[0/257] Loss: 8.5321
[52/257] Loss: 8.7775
[104/257] Loss: 8.5060
[156/257] Loss: 8.6297
[208/257] Loss: 8.7022
loss in epoch 70: 8.726194381713867
Epoch: 71
[0/257] Loss: 8.6749
[52/257] Loss: 8.7016
[104/257] Loss: 8.6391
[156/257] Loss: 8.6561
[208/257] Loss: 8.7475
loss in epoch 71: 8.765262603759766
Epoch: 72
[0/257] Loss: 8.6030
[52/257] Loss: 8.6028
[104/257] Loss: 8.7000
[156/257] Loss: 8.6162
[208/257] Loss: 8.7676
loss in epoch 72: 8.702104568481445
Epoch: 73
[0/257] Loss: 8.5396
[52/257] Loss: 8.6556
[104/257] Loss: 8.6647
[156/257] Loss: 8.5781
[208/257] Loss: 8.6109
loss in epoch 73: 8.764448165893555
Epoch: 74
[0/257] Loss: 8.6191
[52/257] Loss: 8.6027
[104/257] Loss: 8.6557
[156/257] Loss: 8.7545
[208/257] Loss: 8.6732
loss in epoch 74: 8.730546951293945
Epoch: 75
[0/257] Loss: 8.7031
[52/257] Loss: 8.5403
[104/257] Loss: 8.5907
[156/257] Loss: 8.5808
[208/257] Loss: 8.5812
loss in epoch 75: 8.663631439208984
Epoch: 76
[0/257] Loss: 8.5548
[52/257] Loss: 8.5565
[104/257] Loss: 8.6570
[156/257] Loss: 8.5976
[208/257] Loss: 8.7098
loss in epoch 76: 8.737221717834473
Epoch: 77
[0/257] Loss: 8.6525
[52/257] Loss: 8.6478
[104/257] Loss: 8.6219
[156/257] Loss: 8.7048
[208/257] Loss: 8.6612
loss in epoch 77: 8.547018051147461
Epoch: 78
[0/257] Loss: 8.5566
[52/257] Loss: 8.6725
[104/257] Loss: 8.5404
[156/257] Loss: 8.6049
[208/257] Loss: 8.7350
loss in epoch 78: 8.642959594726562
Epoch: 79
[0/257] Loss: 8.6048
[52/257] Loss: 8.7083
[104/257] Loss: 8.5674
[156/257] Loss: 8.7253
[208/257] Loss: 8.6396
loss in epoch 79: 8.629456520080566
Epoch: 80
[0/257] Loss: 8.6763
[52/257] Loss: 8.5450
[104/257] Loss: 8.5948
[156/257] Loss: 8.6239
[208/257] Loss: 8.6811
loss in epoch 80: 8.745388984680176
start predicting:  2024-12-06 11:52:41.065418
{'Best_HR@5': 0.8789, 'Best_NDCG@5': 0.5325, 'Best_HR@10': 1.6158, 'Best_NDCG@10': 0.758, 'Best_HR@20': 2.7077, 'Best_NDCG@20': 1.0319}
{'Best_epoch_HR@5': 20, 'Best_epoch_NDCG@5': 20, 'Best_epoch_HR@10': 80, 'Best_epoch_NDCG@10': 80, 'Best_epoch_HR@20': 80, 'Best_epoch_NDCG@20': 80}
Epoch: 81
[0/257] Loss: 8.5861
[52/257] Loss: 8.6039
[104/257] Loss: 8.6556
[156/257] Loss: 8.5890
[208/257] Loss: 8.7399
loss in epoch 81: 8.585112571716309
Epoch: 82
[0/257] Loss: 8.6363
[52/257] Loss: 8.6633
[104/257] Loss: 8.6438
[156/257] Loss: 8.6279
[208/257] Loss: 8.6118
loss in epoch 82: 8.628713607788086
Epoch: 83
[0/257] Loss: 8.5920
[52/257] Loss: 8.6879
[104/257] Loss: 8.6362
[156/257] Loss: 8.6286
[208/257] Loss: 8.7397
loss in epoch 83: 8.613718032836914
Epoch: 84
[0/257] Loss: 8.6912
[52/257] Loss: 8.5562
[104/257] Loss: 8.5207
[156/257] Loss: 8.6120
[208/257] Loss: 8.6011
loss in epoch 84: 8.684459686279297
Epoch: 85
[0/257] Loss: 8.6906
[52/257] Loss: 8.6453
[104/257] Loss: 8.7186
[156/257] Loss: 8.6643
[208/257] Loss: 8.5842
loss in epoch 85: 8.758011817932129
Epoch: 86
[0/257] Loss: 8.5479
[52/257] Loss: 8.6769
[104/257] Loss: 8.6522
[156/257] Loss: 8.5754
[208/257] Loss: 8.6507
loss in epoch 86: 8.705154418945312
Epoch: 87
[0/257] Loss: 8.6026
[52/257] Loss: 8.6472
[104/257] Loss: 8.6297
[156/257] Loss: 8.6953
[208/257] Loss: 8.6064
loss in epoch 87: 8.630366325378418
Epoch: 88
[0/257] Loss: 8.6062
[52/257] Loss: 8.5301
[104/257] Loss: 8.6248
[156/257] Loss: 8.6029
[208/257] Loss: 8.6151
loss in epoch 88: 8.720683097839355
Epoch: 89
[0/257] Loss: 8.6776
[52/257] Loss: 8.6453
[104/257] Loss: 8.6059
[156/257] Loss: 8.7061
[208/257] Loss: 8.6537
loss in epoch 89: 8.537693977355957
Epoch: 90
[0/257] Loss: 8.6228
[52/257] Loss: 8.5830
[104/257] Loss: 8.6934
[156/257] Loss: 8.6489
[208/257] Loss: 8.7061
loss in epoch 90: 8.620468139648438
Epoch: 91
[0/257] Loss: 8.6857
[52/257] Loss: 8.6109
[104/257] Loss: 8.5633
[156/257] Loss: 8.6872
[208/257] Loss: 8.6440
loss in epoch 91: 8.715838432312012
Epoch: 92
[0/257] Loss: 8.5742
[52/257] Loss: 8.7226
[104/257] Loss: 8.6050
[156/257] Loss: 8.6715
[208/257] Loss: 8.7220
loss in epoch 92: 8.657537460327148
Epoch: 93
[0/257] Loss: 8.5874
[52/257] Loss: 8.6174
[104/257] Loss: 8.5645
[156/257] Loss: 8.4819
[208/257] Loss: 8.5411
loss in epoch 93: 8.57225513458252
Epoch: 94
[0/257] Loss: 8.5047
[52/257] Loss: 8.5646
[104/257] Loss: 8.6254
[156/257] Loss: 8.6075
[208/257] Loss: 8.5618
loss in epoch 94: 8.634552955627441
Epoch: 95
[0/257] Loss: 8.6258
[52/257] Loss: 8.6010
[104/257] Loss: 8.6540
[156/257] Loss: 8.5892
[208/257] Loss: 8.5893
loss in epoch 95: 8.59858226776123
Epoch: 96
[0/257] Loss: 8.5337
[52/257] Loss: 8.6188
[104/257] Loss: 8.5945
[156/257] Loss: 8.6040
[208/257] Loss: 8.6059
loss in epoch 96: 8.633808135986328
Epoch: 97
[0/257] Loss: 8.4441
[52/257] Loss: 8.6931
[104/257] Loss: 8.4612
[156/257] Loss: 8.5007
[208/257] Loss: 8.6229
loss in epoch 97: 8.633896827697754
Epoch: 98
[0/257] Loss: 8.5290
[52/257] Loss: 8.5412
[104/257] Loss: 8.5863
[156/257] Loss: 8.5104
[208/257] Loss: 8.6399
loss in epoch 98: 8.480857849121094
Epoch: 99
[0/257] Loss: 8.4635
[52/257] Loss: 8.4770
[104/257] Loss: 8.6024
[156/257] Loss: 8.5740
[208/257] Loss: 8.6381
loss in epoch 99: 8.570962905883789
Epoch: 100
[0/257] Loss: 8.5556
[52/257] Loss: 8.4417
[104/257] Loss: 8.4619
[156/257] Loss: 8.4901
[208/257] Loss: 8.5948
loss in epoch 100: 8.442042350769043
start predicting:  2024-12-06 12:03:34.281357
Epoch: 101
[0/257] Loss: 8.5632
[52/257] Loss: 8.5260
[104/257] Loss: 8.4503
[156/257] Loss: 8.4893
[208/257] Loss: 8.6708
loss in epoch 101: 8.567821502685547
Epoch: 102
[0/257] Loss: 8.5425
[52/257] Loss: 8.5114
[104/257] Loss: 8.5805
[156/257] Loss: 8.5859
[208/257] Loss: 8.4933
loss in epoch 102: 8.466585159301758
Epoch: 103
[0/257] Loss: 8.4614
[52/257] Loss: 8.5364
[104/257] Loss: 8.4867
[156/257] Loss: 8.4994
[208/257] Loss: 8.5878
loss in epoch 103: 8.449148178100586
Epoch: 104
[0/257] Loss: 8.5375
[52/257] Loss: 8.5970
[104/257] Loss: 8.5291
[156/257] Loss: 8.4137
[208/257] Loss: 8.5035
loss in epoch 104: 8.467103004455566
Epoch: 105
[0/257] Loss: 8.5379
[52/257] Loss: 8.4727
[104/257] Loss: 8.4845
[156/257] Loss: 8.4003
[208/257] Loss: 8.3892
loss in epoch 105: 8.3234281539917
Epoch: 106
[0/257] Loss: 8.4508
[52/257] Loss: 8.6269
[104/257] Loss: 8.3868
[156/257] Loss: 8.4009
[208/257] Loss: 8.5161
loss in epoch 106: 8.484108924865723
Epoch: 107
[0/257] Loss: 8.5040
[52/257] Loss: 8.5250
[104/257] Loss: 8.5960
[156/257] Loss: 8.5027
[208/257] Loss: 8.4828
loss in epoch 107: 8.441926002502441
Epoch: 108
[0/257] Loss: 8.4115
[52/257] Loss: 8.5686
[104/257] Loss: 8.5375
[156/257] Loss: 8.5121
[208/257] Loss: 8.5923
loss in epoch 108: 8.554252624511719
Epoch: 109
[0/257] Loss: 8.6055
[52/257] Loss: 8.4229
[104/257] Loss: 8.3466
[156/257] Loss: 8.5969
[208/257] Loss: 8.5805
loss in epoch 109: 8.569894790649414
Epoch: 110
[0/257] Loss: 8.4195
[52/257] Loss: 8.4127
[104/257] Loss: 8.4840
[156/257] Loss: 8.5760
[208/257] Loss: 8.4683
loss in epoch 110: 8.344151496887207
Epoch: 111
[0/257] Loss: 8.4833
[52/257] Loss: 8.4492
[104/257] Loss: 8.4534
[156/257] Loss: 8.4102
[208/257] Loss: 8.4262
loss in epoch 111: 8.596427917480469
Epoch: 112
[0/257] Loss: 8.4972
[52/257] Loss: 8.6559
[104/257] Loss: 8.4963
[156/257] Loss: 8.4976
[208/257] Loss: 8.4689
loss in epoch 112: 8.529630661010742
Epoch: 113
[0/257] Loss: 8.5221
[52/257] Loss: 8.5511
[104/257] Loss: 8.5124
[156/257] Loss: 8.5545
[208/257] Loss: 8.4889
loss in epoch 113: 8.397686004638672
Epoch: 114
[0/257] Loss: 8.5547
[52/257] Loss: 8.4416
[104/257] Loss: 8.5106
[156/257] Loss: 8.4641
[208/257] Loss: 8.5045
loss in epoch 114: 8.64058780670166
Epoch: 115
[0/257] Loss: 8.4578
[52/257] Loss: 8.5024
[104/257] Loss: 8.4855
[156/257] Loss: 8.5073
[208/257] Loss: 8.4611
loss in epoch 115: 8.570414543151855
Epoch: 116
[0/257] Loss: 8.5022
[52/257] Loss: 8.4492
[104/257] Loss: 8.4715
[156/257] Loss: 8.5298
[208/257] Loss: 8.4976
loss in epoch 116: 8.531620025634766
Epoch: 117
[0/257] Loss: 8.4305
[52/257] Loss: 8.5117
[104/257] Loss: 8.4695
[156/257] Loss: 8.5088
[208/257] Loss: 8.4659
loss in epoch 117: 8.44116497039795
Epoch: 118
[0/257] Loss: 8.4510
[52/257] Loss: 8.5508
[104/257] Loss: 8.5055
[156/257] Loss: 8.3809
[208/257] Loss: 8.5310
loss in epoch 118: 8.468118667602539
Epoch: 119
[0/257] Loss: 8.4585
[52/257] Loss: 8.5406
[104/257] Loss: 8.5448
[156/257] Loss: 8.4708
[208/257] Loss: 8.4292
loss in epoch 119: 8.575932502746582
Epoch: 120
[0/257] Loss: 8.5749
[52/257] Loss: 8.4463
[104/257] Loss: 8.5052
[156/257] Loss: 8.5699
[208/257] Loss: 8.5004
loss in epoch 120: 8.526182174682617
start predicting:  2024-12-06 12:13:43.075532
Epoch: 121
[0/257] Loss: 8.4492
[52/257] Loss: 8.5341
[104/257] Loss: 8.4887
[156/257] Loss: 8.2562
[208/257] Loss: 8.4816
loss in epoch 121: 8.389087677001953
Epoch: 122
[0/257] Loss: 8.4997
[52/257] Loss: 8.5724
[104/257] Loss: 8.4540
[156/257] Loss: 8.4722
[208/257] Loss: 8.4234
loss in epoch 122: 8.610370635986328
Epoch: 123
[0/257] Loss: 8.5679
[52/257] Loss: 8.4541
[104/257] Loss: 8.4746
[156/257] Loss: 8.4933
[208/257] Loss: 8.5031
loss in epoch 123: 8.370024681091309
Epoch: 124
[0/257] Loss: 8.3636
[52/257] Loss: 8.5772
[104/257] Loss: 8.4549
[156/257] Loss: 8.5369
[208/257] Loss: 8.6973
loss in epoch 124: 8.641203880310059
Epoch: 125
[0/257] Loss: 8.4633
[52/257] Loss: 8.4310
[104/257] Loss: 8.4165
[156/257] Loss: 8.4210
[208/257] Loss: 8.4885
loss in epoch 125: 8.59865665435791
Epoch: 126
[0/257] Loss: 8.3617
[52/257] Loss: 8.4866
[104/257] Loss: 8.5641
[156/257] Loss: 8.5426
[208/257] Loss: 8.3329
loss in epoch 126: 8.548620223999023
Epoch: 127
[0/257] Loss: 8.3985
[52/257] Loss: 8.3919
[104/257] Loss: 8.5094
[156/257] Loss: 8.5848
[208/257] Loss: 8.4619
loss in epoch 127: 8.578243255615234
Epoch: 128
[0/257] Loss: 8.4036
[52/257] Loss: 8.4928
[104/257] Loss: 8.3686
[156/257] Loss: 8.4698
[208/257] Loss: 8.4937
loss in epoch 128: 8.54411792755127
Epoch: 129
[0/257] Loss: 8.4655
[52/257] Loss: 8.4836
[104/257] Loss: 8.3839
[156/257] Loss: 8.4979
[208/257] Loss: 8.3773
loss in epoch 129: 8.480291366577148
Epoch: 130
[0/257] Loss: 8.4738
[52/257] Loss: 8.5362
[104/257] Loss: 8.4009
[156/257] Loss: 8.4931
[208/257] Loss: 8.4192
loss in epoch 130: 8.292094230651855
Epoch: 131
[0/257] Loss: 8.4116
[52/257] Loss: 8.3871
[104/257] Loss: 8.4406
[156/257] Loss: 8.3870
[208/257] Loss: 8.4601
loss in epoch 131: 8.397809982299805
Epoch: 132
[0/257] Loss: 8.3318
[52/257] Loss: 8.4299
[104/257] Loss: 8.4287
[156/257] Loss: 8.4107
[208/257] Loss: 8.4920
loss in epoch 132: 8.507341384887695
Epoch: 133
[0/257] Loss: 8.4850
[52/257] Loss: 8.4564
[104/257] Loss: 8.5535
[156/257] Loss: 8.4512
[208/257] Loss: 8.2502
loss in epoch 133: 8.462798118591309
Epoch: 134
[0/257] Loss: 8.4870
[52/257] Loss: 8.3919
[104/257] Loss: 8.3553
[156/257] Loss: 8.4517
[208/257] Loss: 8.4394
loss in epoch 134: 8.54149341583252
Epoch: 135
[0/257] Loss: 8.4068
[52/257] Loss: 8.4592
[104/257] Loss: 8.4061
[156/257] Loss: 8.2980
[208/257] Loss: 8.3921
loss in epoch 135: 8.362881660461426
Epoch: 136
[0/257] Loss: 8.3264
[52/257] Loss: 8.4413
[104/257] Loss: 8.4098
[156/257] Loss: 8.4946
[208/257] Loss: 8.4530
loss in epoch 136: 8.437499046325684
Epoch: 137
[0/257] Loss: 8.3735
[52/257] Loss: 8.3826
[104/257] Loss: 8.2571
[156/257] Loss: 8.3498
[208/257] Loss: 8.4464
loss in epoch 137: 8.488308906555176
Epoch: 138
[0/257] Loss: 8.4342
[52/257] Loss: 8.3194
[104/257] Loss: 8.3492
[156/257] Loss: 8.2640
[208/257] Loss: 8.4458
loss in epoch 138: 8.523763656616211
Epoch: 139
[0/257] Loss: 8.3654
[52/257] Loss: 8.4747
[104/257] Loss: 8.3891
[156/257] Loss: 8.4357
[208/257] Loss: 8.2751
loss in epoch 139: 8.237188339233398
Epoch: 140
[0/257] Loss: 8.4974
[52/257] Loss: 8.3287
[104/257] Loss: 8.3332
[156/257] Loss: 8.3926
[208/257] Loss: 8.3500
loss in epoch 140: 8.397651672363281
start predicting:  2024-12-06 12:21:27.667365
Epoch: 141
[0/257] Loss: 8.3647
[52/257] Loss: 8.1788
[104/257] Loss: 8.2777
[156/257] Loss: 8.3504
[208/257] Loss: 8.3316
loss in epoch 141: 8.516349792480469
Epoch: 142
[0/257] Loss: 8.2403
[52/257] Loss: 8.3386
[104/257] Loss: 8.4474
[156/257] Loss: 8.4260
[208/257] Loss: 8.3614
loss in epoch 142: 8.1053466796875
Epoch: 143
[0/257] Loss: 8.3369
[52/257] Loss: 8.4206
[104/257] Loss: 8.3034
[156/257] Loss: 8.4575
[208/257] Loss: 8.3033
loss in epoch 143: 8.44197940826416
Epoch: 144
[0/257] Loss: 8.5049
[52/257] Loss: 8.3416
[104/257] Loss: 8.2091
[156/257] Loss: 8.3751
[208/257] Loss: 8.4758
loss in epoch 144: 8.29814338684082
Epoch: 145
[0/257] Loss: 8.3091
[52/257] Loss: 8.4391
[104/257] Loss: 8.2639
[156/257] Loss: 8.2899
[208/257] Loss: 8.4451
loss in epoch 145: 8.392361640930176
Epoch: 146
[0/257] Loss: 8.2489
[52/257] Loss: 8.3394
[104/257] Loss: 8.3697
[156/257] Loss: 8.3002
[208/257] Loss: 8.2909
loss in epoch 146: 8.259476661682129
Epoch: 147
[0/257] Loss: 8.1830
[52/257] Loss: 8.3159
[104/257] Loss: 8.4523
[156/257] Loss: 8.3750
[208/257] Loss: 8.2988
loss in epoch 147: 8.360550880432129
Epoch: 148
[0/257] Loss: 8.4293
[52/257] Loss: 8.3956
[104/257] Loss: 8.2763
[156/257] Loss: 8.2547
[208/257] Loss: 8.3240
loss in epoch 148: 8.415011405944824
Epoch: 149
[0/257] Loss: 8.2088
[52/257] Loss: 8.3484
[104/257] Loss: 8.2788
[156/257] Loss: 8.2997
[208/257] Loss: 8.3518
loss in epoch 149: 8.303630828857422
Epoch: 150
[0/257] Loss: 8.3005
[52/257] Loss: 8.4096
[104/257] Loss: 8.3353
[156/257] Loss: 8.1400
[208/257] Loss: 8.3388
loss in epoch 150: 8.3810453414917
Epoch: 151
[0/257] Loss: 8.2681
[52/257] Loss: 8.3470
[104/257] Loss: 8.1757
[156/257] Loss: 8.3052
[208/257] Loss: 8.2137
loss in epoch 151: 8.298140525817871
Epoch: 152
[0/257] Loss: 8.2992
[52/257] Loss: 8.2635
[104/257] Loss: 8.2653
[156/257] Loss: 8.2938
[208/257] Loss: 8.4051
loss in epoch 152: 8.42046070098877
Epoch: 153
[0/257] Loss: 8.2863
[52/257] Loss: 8.2860
[104/257] Loss: 8.2202
[156/257] Loss: 8.2754
[208/257] Loss: 8.3848
loss in epoch 153: 8.265884399414062
Epoch: 154
[0/257] Loss: 8.2874
[52/257] Loss: 8.3259
[104/257] Loss: 8.2970
[156/257] Loss: 8.3482
[208/257] Loss: 8.2398
loss in epoch 154: 8.344915390014648
Epoch: 155
[0/257] Loss: 8.2764
[52/257] Loss: 8.1888
[104/257] Loss: 8.2737
[156/257] Loss: 8.3919
[208/257] Loss: 8.1749
loss in epoch 155: 8.175691604614258
Epoch: 156
[0/257] Loss: 8.2645
[52/257] Loss: 8.1856
[104/257] Loss: 8.2934
[156/257] Loss: 8.1689
[208/257] Loss: 8.3453
loss in epoch 156: 8.230098724365234
Epoch: 157
[0/257] Loss: 8.2823
[52/257] Loss: 8.2899
[104/257] Loss: 8.2251
[156/257] Loss: 8.1609
[208/257] Loss: 8.2144
loss in epoch 157: 8.274740219116211
Epoch: 158
[0/257] Loss: 8.3353
[52/257] Loss: 8.2839
[104/257] Loss: 8.2023
[156/257] Loss: 8.3278
[208/257] Loss: 8.2920
loss in epoch 158: 8.331710815429688
Epoch: 159
[0/257] Loss: 8.2293
[52/257] Loss: 8.2354
[104/257] Loss: 8.2402
[156/257] Loss: 8.0234
[208/257] Loss: 8.2585
loss in epoch 159: 8.26934814453125
Epoch: 160
[0/257] Loss: 8.1520
[52/257] Loss: 8.3595
[104/257] Loss: 8.2960
[156/257] Loss: 8.2389
[208/257] Loss: 8.2558
loss in epoch 160: 7.947685718536377
start predicting:  2024-12-06 12:29:16.499539
Epoch: 161
[0/257] Loss: 8.2228
[52/257] Loss: 8.1556
[104/257] Loss: 8.1806
[156/257] Loss: 8.1159
[208/257] Loss: 8.2346
loss in epoch 161: 8.261212348937988
Epoch: 162
[0/257] Loss: 8.2861
[52/257] Loss: 8.2172
[104/257] Loss: 8.2397
[156/257] Loss: 8.1382
[208/257] Loss: 8.0296
loss in epoch 162: 8.245776176452637
Epoch: 163
[0/257] Loss: 8.1437
[52/257] Loss: 8.3507
[104/257] Loss: 8.1883
[156/257] Loss: 8.1698
[208/257] Loss: 8.3148
loss in epoch 163: 8.09156608581543
Epoch: 164
[0/257] Loss: 8.2257
[52/257] Loss: 8.2965
[104/257] Loss: 8.2465
[156/257] Loss: 8.1512
[208/257] Loss: 8.2851
loss in epoch 164: 8.211186408996582
Epoch: 165
[0/257] Loss: 8.2892
[52/257] Loss: 8.1606
[104/257] Loss: 8.2214
[156/257] Loss: 8.0693
[208/257] Loss: 8.2296
loss in epoch 165: 8.272921562194824
Epoch: 166
[0/257] Loss: 8.0246
[52/257] Loss: 8.1300
[104/257] Loss: 8.2021
[156/257] Loss: 8.3276
[208/257] Loss: 7.9876
loss in epoch 166: 8.108403205871582
Epoch: 167
[0/257] Loss: 8.1461
[52/257] Loss: 8.2113
[104/257] Loss: 8.0369
[156/257] Loss: 8.1680
[208/257] Loss: 8.2314
loss in epoch 167: 8.26722526550293
Epoch: 168
[0/257] Loss: 8.2323
[52/257] Loss: 8.1417
[104/257] Loss: 8.2336
[156/257] Loss: 8.1615
[208/257] Loss: 8.1329
loss in epoch 168: 8.047780990600586
Epoch: 169
[0/257] Loss: 8.1473
[52/257] Loss: 8.0864
[104/257] Loss: 7.9902
[156/257] Loss: 8.1063
[208/257] Loss: 8.1809
loss in epoch 169: 8.148573875427246
Epoch: 170
[0/257] Loss: 8.0064
[52/257] Loss: 8.1152
[104/257] Loss: 8.0731
[156/257] Loss: 7.9946
[208/257] Loss: 8.1149
loss in epoch 170: 8.229050636291504
Epoch: 171
[0/257] Loss: 8.2906
[52/257] Loss: 8.0453
[104/257] Loss: 8.1840
[156/257] Loss: 8.0388
[208/257] Loss: 8.1371
loss in epoch 171: 8.044638633728027
Epoch: 172
[0/257] Loss: 8.2066
[52/257] Loss: 7.9095
[104/257] Loss: 8.1547
[156/257] Loss: 8.1244
[208/257] Loss: 8.0376
loss in epoch 172: 8.117179870605469
Epoch: 173
[0/257] Loss: 8.1366
[52/257] Loss: 8.2133
[104/257] Loss: 8.2914
[156/257] Loss: 8.0575
[208/257] Loss: 8.0918
loss in epoch 173: 8.048638343811035
Epoch: 174
[0/257] Loss: 8.1947
[52/257] Loss: 8.1152
[104/257] Loss: 8.0890
[156/257] Loss: 8.2163
[208/257] Loss: 8.2300
loss in epoch 174: 8.086281776428223
Epoch: 175
[0/257] Loss: 8.0947
[52/257] Loss: 8.1498
[104/257] Loss: 8.3059
[156/257] Loss: 8.2571
[208/257] Loss: 8.1796
loss in epoch 175: 8.151092529296875
Epoch: 176
[0/257] Loss: 8.0117
[52/257] Loss: 8.0953
[104/257] Loss: 8.1767
[156/257] Loss: 8.2610
[208/257] Loss: 8.1069
loss in epoch 176: 8.199251174926758
Epoch: 177
[0/257] Loss: 7.9569
[52/257] Loss: 8.0089
[104/257] Loss: 7.9971
[156/257] Loss: 8.2593
[208/257] Loss: 8.1429
loss in epoch 177: 8.177816390991211
Epoch: 178
[0/257] Loss: 8.0833
[52/257] Loss: 8.0497
[104/257] Loss: 8.1083
[156/257] Loss: 8.1297
[208/257] Loss: 8.0105
loss in epoch 178: 8.109917640686035
Epoch: 179
[0/257] Loss: 8.0910
[52/257] Loss: 7.9827
[104/257] Loss: 8.1171
[156/257] Loss: 8.0862
[208/257] Loss: 7.8896
loss in epoch 179: 8.156118392944336
Epoch: 180
[0/257] Loss: 7.9036
[52/257] Loss: 8.0434
[104/257] Loss: 8.1767
[156/257] Loss: 8.0568
[208/257] Loss: 7.9431
loss in epoch 180: 8.023494720458984
start predicting:  2024-12-06 12:37:07.536333
Test------------------------------------------------------
{'HR@5': 0.0977, 'NDCG@5': 0.0544, 'HR@10': 0.1642, 'NDCG@10': 0.0751, 'HR@20': 0.3063, 'NDCG@20': 0.1104}
Best Eval---------------------------------------------------------
{'Best_HR@5': 0.8789, 'Best_NDCG@5': 0.5325, 'Best_HR@10': 1.6158, 'Best_NDCG@10': 0.758, 'Best_HR@20': 2.7077, 'Best_NDCG@20': 1.0319}
{'Best_epoch_HR@5': 20, 'Best_epoch_NDCG@5': 20, 'Best_epoch_HR@10': 80, 'Best_epoch_NDCG@10': 80, 'Best_epoch_HR@20': 80, 'Best_epoch_NDCG@20': 80}
Namespace(batch_size=512, dataset='amazon_beauty', decay_step=100, description='Diffu_norm_score', device='cuda', diffusion_steps=32, diversity_measure=False, dropout=0.1, emb_dropout=0.3, epoch_time_avg=False, epochs=500, eval_interval=20, gamma=0.1, hidden_act='gelu', hidden_size=128, item_num=12101, lambda_uncertainty=0.001, log_file='log/', long_head=False, loss_lambda=0.001, lr=0.001, max_len=50, metric_ks=[5, 10, 20], momentum=None, noise_schedule='trunc_lin', num_blocks=4, num_gpu=1, optimizer='Adam', patience=5, random_seed=1997, rescale_timesteps=True, schedule_sampler_name='lossaware', weight_decay=0)
