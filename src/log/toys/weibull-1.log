nohup: ignoring input
Namespace(batch_size=512, dataset='toys', decay_step=100, description='Diffu_norm_score', device='cuda', diffusion_steps=32, diversity_measure=False, dropout=0.1, emb_dropout=0.3, epoch_time_avg=False, epochs=500, eval_interval=20, gamma=0.1, hidden_act='gelu', hidden_size=128, lambda_uncertainty=0.001, log_file='log/', long_head=False, loss_lambda=0.001, lr=0.001, max_len=50, metric_ks=[5, 10, 20], momentum=None, noise_schedule='trunc_lin', num_blocks=4, num_gpu=1, optimizer='Adam', patience=5, random_seed=1997, rescale_timesteps=True, schedule_sampler_name='lossaware', weight_decay=0)
Epoch: 0
[0/214] Loss: 40.6512
[43/214] Loss: 38.3724
[86/214] Loss: 35.9650
[129/214] Loss: 33.6292
[172/214] Loss: 31.9330
loss in epoch 0: 28.903514862060547
Epoch: 1
[0/214] Loss: 29.4710
[43/214] Loss: 27.8525
[86/214] Loss: 26.6947
[129/214] Loss: 24.8274
[172/214] Loss: 21.7423
loss in epoch 1: 17.453723907470703
Epoch: 2
[0/214] Loss: 18.5091
[43/214] Loss: 14.3536
[86/214] Loss: 12.2585
[129/214] Loss: 11.1881
[172/214] Loss: 10.2798
loss in epoch 2: 10.143088340759277
Epoch: 3
[0/214] Loss: 10.0618
[43/214] Loss: 10.0957
[86/214] Loss: 9.9982
[129/214] Loss: 9.8098
[172/214] Loss: 9.7530
loss in epoch 3: 9.669934272766113
Epoch: 4
[0/214] Loss: 9.7191
[43/214] Loss: 9.6884
[86/214] Loss: 9.6916
[129/214] Loss: 9.8894
[172/214] Loss: 9.6453
loss in epoch 4: 9.506779670715332
Epoch: 5
[0/214] Loss: 9.5212
[43/214] Loss: 9.5908
[86/214] Loss: 9.5423
[129/214] Loss: 9.5774
[172/214] Loss: 9.6063
loss in epoch 5: 9.424723625183105
Epoch: 6
[0/214] Loss: 9.4627
[43/214] Loss: 9.4421
[86/214] Loss: 9.3490
[129/214] Loss: 9.3873
[172/214] Loss: 9.3225
loss in epoch 6: 9.411245346069336
Epoch: 7
[0/214] Loss: 9.3475
[43/214] Loss: 9.4813
[86/214] Loss: 9.3538
[129/214] Loss: 9.3557
[172/214] Loss: 9.3604
loss in epoch 7: 9.323637008666992
Epoch: 8
[0/214] Loss: 9.3345
[43/214] Loss: 9.3455
[86/214] Loss: 9.2983
[129/214] Loss: 9.3329
[172/214] Loss: 9.2197
loss in epoch 8: 9.291312217712402
Epoch: 9
[0/214] Loss: 9.2900
[43/214] Loss: 9.2204
[86/214] Loss: 9.2867
[129/214] Loss: 9.2094
[172/214] Loss: 9.2222
loss in epoch 9: 9.227690696716309
Epoch: 10
[0/214] Loss: 9.1798
[43/214] Loss: 9.1818
[86/214] Loss: 9.1944
[129/214] Loss: 9.2381
[172/214] Loss: 9.2108
loss in epoch 10: 9.048989295959473
Epoch: 11
[0/214] Loss: 9.0957
[43/214] Loss: 9.1937
[86/214] Loss: 9.1406
[129/214] Loss: 9.1195
[172/214] Loss: 9.0873
loss in epoch 11: 9.109482765197754
Epoch: 12
[0/214] Loss: 9.0651
[43/214] Loss: 9.1556
[86/214] Loss: 9.0547
[129/214] Loss: 9.0871
[172/214] Loss: 9.0101
loss in epoch 12: 9.094319343566895
Epoch: 13
[0/214] Loss: 9.0544
[43/214] Loss: 8.9826
[86/214] Loss: 9.0438
[129/214] Loss: 9.0681
[172/214] Loss: 9.1358
loss in epoch 13: 9.01865291595459
Epoch: 14
[0/214] Loss: 9.0034
[43/214] Loss: 9.0410
[86/214] Loss: 9.1104
[129/214] Loss: 9.0439
[172/214] Loss: 9.0148
loss in epoch 14: 8.995330810546875
Epoch: 15
[0/214] Loss: 9.0138
[43/214] Loss: 9.0155
[86/214] Loss: 8.9289
[129/214] Loss: 9.0938
[172/214] Loss: 8.9986
loss in epoch 15: 9.043582916259766
Epoch: 16
[0/214] Loss: 8.9487
[43/214] Loss: 8.9265
[86/214] Loss: 8.9032
[129/214] Loss: 8.9636
[172/214] Loss: 8.9459
loss in epoch 16: 9.113157272338867
Epoch: 17
[0/214] Loss: 8.9330
[43/214] Loss: 9.0026
[86/214] Loss: 9.1388
[129/214] Loss: 8.9776
[172/214] Loss: 9.0917
loss in epoch 17: 8.991066932678223
Epoch: 18
[0/214] Loss: 8.9935
[43/214] Loss: 9.0201
[86/214] Loss: 8.9604
[129/214] Loss: 8.9586
[172/214] Loss: 8.9494
loss in epoch 18: 9.018448829650879
Epoch: 19
[0/214] Loss: 8.9454
[43/214] Loss: 8.9435
[86/214] Loss: 8.9661
[129/214] Loss: 8.9990
[172/214] Loss: 8.8783
loss in epoch 19: 9.040813446044922
Epoch: 20
[0/214] Loss: 8.9834
[43/214] Loss: 8.9536
[86/214] Loss: 8.8894
[129/214] Loss: 8.9624
[172/214] Loss: 8.9707
loss in epoch 20: 9.009501457214355
start predicting:  2024-12-06 13:48:25.260054
{'Best_HR@5': 0.8434, 'Best_NDCG@5': 0.5337, 'Best_HR@10': 1.2083, 'Best_NDCG@10': 0.6524, 'Best_HR@20': 1.8919, 'Best_NDCG@20': 0.8245}
{'Best_epoch_HR@5': 20, 'Best_epoch_NDCG@5': 20, 'Best_epoch_HR@10': 20, 'Best_epoch_NDCG@10': 20, 'Best_epoch_HR@20': 20, 'Best_epoch_NDCG@20': 20}
Epoch: 21
[0/214] Loss: 8.9904
[43/214] Loss: 8.9403
[86/214] Loss: 8.9169
[129/214] Loss: 8.9484
[172/214] Loss: 8.9086
loss in epoch 21: 8.963144302368164
Epoch: 22
[0/214] Loss: 8.9845
[43/214] Loss: 9.0889
[86/214] Loss: 9.0164
[129/214] Loss: 9.0152
[172/214] Loss: 9.0198
loss in epoch 22: 9.052618980407715
Epoch: 23
[0/214] Loss: 8.9196
[43/214] Loss: 8.9797
[86/214] Loss: 9.0158
[129/214] Loss: 9.3698
[172/214] Loss: 9.0656
loss in epoch 23: 8.940914154052734
Epoch: 24
[0/214] Loss: 9.0333
[43/214] Loss: 9.0304
[86/214] Loss: 8.9698
[129/214] Loss: 8.9705
[172/214] Loss: 9.0672
loss in epoch 24: 9.062149047851562
Epoch: 25
[0/214] Loss: 8.9952
[43/214] Loss: 9.0411
[86/214] Loss: 9.0346
[129/214] Loss: 9.0805
[172/214] Loss: 9.0560
loss in epoch 25: 8.93795108795166
Epoch: 26
[0/214] Loss: 8.9827
[43/214] Loss: 9.0142
[86/214] Loss: 9.0177
[129/214] Loss: 8.9974
[172/214] Loss: 9.0120
loss in epoch 26: 8.978972434997559
Epoch: 27
[0/214] Loss: 8.9810
[43/214] Loss: 8.9912
[86/214] Loss: 9.0177
[129/214] Loss: 8.9428
[172/214] Loss: 9.0297
loss in epoch 27: 8.875919342041016
Epoch: 28
[0/214] Loss: 8.9491
[43/214] Loss: 8.9211
[86/214] Loss: 8.9971
[129/214] Loss: 9.0086
[172/214] Loss: 9.0315
loss in epoch 28: 8.901798248291016
Epoch: 29
[0/214] Loss: 8.9642
[43/214] Loss: 8.9358
[86/214] Loss: 8.9112
[129/214] Loss: 8.9638
[172/214] Loss: 9.0200
loss in epoch 29: 9.042662620544434
Epoch: 30
[0/214] Loss: 8.9180
[43/214] Loss: 8.9985
[86/214] Loss: 8.9942
[129/214] Loss: 9.0002
[172/214] Loss: 8.9511
loss in epoch 30: 8.991314888000488
Epoch: 31
[0/214] Loss: 8.9207
[43/214] Loss: 8.9749
[86/214] Loss: 8.9135
[129/214] Loss: 8.9492
[172/214] Loss: 8.9690
loss in epoch 31: 8.976541519165039
Epoch: 32
[0/214] Loss: 8.8996
[43/214] Loss: 8.9614
[86/214] Loss: 8.9248
[129/214] Loss: 8.9246
[172/214] Loss: 8.9071
loss in epoch 32: 8.953073501586914
Epoch: 33
[0/214] Loss: 8.9579
[43/214] Loss: 8.9729
[86/214] Loss: 9.0080
[129/214] Loss: 8.9565
[172/214] Loss: 8.9765
loss in epoch 33: 9.009306907653809
Epoch: 34
[0/214] Loss: 8.9554
[43/214] Loss: 8.9627
[86/214] Loss: 8.9900
[129/214] Loss: 9.0021
[172/214] Loss: 8.9391
loss in epoch 34: 8.974842071533203
Epoch: 35
[0/214] Loss: 8.9783
[43/214] Loss: 8.9399
[86/214] Loss: 9.0133
[129/214] Loss: 8.9846
[172/214] Loss: 8.9549
loss in epoch 35: 9.019231796264648
Epoch: 36
[0/214] Loss: 8.9318
[43/214] Loss: 9.0132
[86/214] Loss: 8.9252
[129/214] Loss: 8.9865
[172/214] Loss: 8.8975
loss in epoch 36: 9.02241325378418
Epoch: 37
[0/214] Loss: 9.0302
[43/214] Loss: 8.8987
[86/214] Loss: 8.9390
[129/214] Loss: 8.9690
[172/214] Loss: 9.0235
loss in epoch 37: 9.016633033752441
Epoch: 38
[0/214] Loss: 8.9894
[43/214] Loss: 8.9254
[86/214] Loss: 8.9656
[129/214] Loss: 8.9811
[172/214] Loss: 9.0087
loss in epoch 38: 9.019932746887207
Epoch: 39
[0/214] Loss: 8.9465
[43/214] Loss: 8.9541
[86/214] Loss: 8.9311
[129/214] Loss: 8.9922
[172/214] Loss: 8.9709
loss in epoch 39: 8.898808479309082
Epoch: 40
[0/214] Loss: 8.9412
[43/214] Loss: 8.9288
[86/214] Loss: 8.9263
[129/214] Loss: 9.0493
[172/214] Loss: 8.8959
loss in epoch 40: 8.968230247497559
start predicting:  2024-12-06 14:46:14.007716
{'Best_HR@5': 0.8537, 'Best_NDCG@5': 0.5337, 'Best_HR@10': 1.2135, 'Best_NDCG@10': 0.6524, 'Best_HR@20': 1.8919, 'Best_NDCG@20': 0.8245}
{'Best_epoch_HR@5': 40, 'Best_epoch_NDCG@5': 20, 'Best_epoch_HR@10': 40, 'Best_epoch_NDCG@10': 20, 'Best_epoch_HR@20': 20, 'Best_epoch_NDCG@20': 20}
Epoch: 41
[0/214] Loss: 8.9217
[43/214] Loss: 8.9144
[86/214] Loss: 8.9753
[129/214] Loss: 9.0162
[172/214] Loss: 8.9236
loss in epoch 41: 9.051088333129883
Epoch: 42
[0/214] Loss: 8.9547
[43/214] Loss: 8.9724
[86/214] Loss: 8.9508
[129/214] Loss: 8.9749
[172/214] Loss: 8.9562
loss in epoch 42: 9.032238006591797
Epoch: 43
[0/214] Loss: 8.8984
[43/214] Loss: 8.9249
[86/214] Loss: 8.8599
[129/214] Loss: 9.0709
[172/214] Loss: 8.9502
loss in epoch 43: 8.993642807006836
Epoch: 44
[0/214] Loss: 8.9703
[43/214] Loss: 8.8989
[86/214] Loss: 8.9464
[129/214] Loss: 8.8827
[172/214] Loss: 8.9464
loss in epoch 44: 8.999120712280273
Epoch: 45
[0/214] Loss: 8.9592
[43/214] Loss: 8.9285
[86/214] Loss: 8.9346
[129/214] Loss: 8.9930
[172/214] Loss: 9.0042
loss in epoch 45: 8.974970817565918
Epoch: 46
[0/214] Loss: 8.9975
[43/214] Loss: 8.9872
[86/214] Loss: 8.9871
[129/214] Loss: 8.9247
[172/214] Loss: 8.9453
loss in epoch 46: 9.02807903289795
Epoch: 47
[0/214] Loss: 8.9211
[43/214] Loss: 8.9815
[86/214] Loss: 8.9238
[129/214] Loss: 8.9698
[172/214] Loss: 8.9374
loss in epoch 47: 8.909330368041992
Epoch: 48
[0/214] Loss: 8.9758
[43/214] Loss: 8.9088
[86/214] Loss: 8.9248
[129/214] Loss: 8.9648
[172/214] Loss: 8.9777
loss in epoch 48: 8.930510520935059
Epoch: 49
[0/214] Loss: 8.9726
[43/214] Loss: 8.9122
[86/214] Loss: 8.9653
[129/214] Loss: 8.9591
[172/214] Loss: 9.0292
loss in epoch 49: 8.950265884399414
Epoch: 50
[0/214] Loss: 8.9386
[43/214] Loss: 8.9859
[86/214] Loss: 8.9008
[129/214] Loss: 8.9777
[172/214] Loss: 9.0031
loss in epoch 50: 9.01407527923584
Epoch: 51
[0/214] Loss: 8.9452
[43/214] Loss: 8.9808
[86/214] Loss: 8.9889
[129/214] Loss: 8.9862
[172/214] Loss: 8.9855
loss in epoch 51: 9.022862434387207
Epoch: 52
[0/214] Loss: 9.0074
[43/214] Loss: 8.9335
[86/214] Loss: 8.9730
[129/214] Loss: 8.9803
[172/214] Loss: 9.0298
loss in epoch 52: 9.048755645751953
Epoch: 53
[0/214] Loss: 8.9166
[43/214] Loss: 8.8762
[86/214] Loss: 8.8580
[129/214] Loss: 8.9791
[172/214] Loss: 8.9939
loss in epoch 53: 8.970858573913574
Epoch: 54
[0/214] Loss: 8.8442
[43/214] Loss: 8.9763
[86/214] Loss: 8.9570
[129/214] Loss: 8.9592
[172/214] Loss: 8.9765
loss in epoch 54: 8.970069885253906
Epoch: 55
[0/214] Loss: 8.9337
[43/214] Loss: 8.9740
[86/214] Loss: 8.9806
[129/214] Loss: 8.9204
[172/214] Loss: 8.9774
loss in epoch 55: 9.030243873596191
Epoch: 56
[0/214] Loss: 9.0049
[43/214] Loss: 8.9315
[86/214] Loss: 8.9981
[129/214] Loss: 8.9306
[172/214] Loss: 8.8866
loss in epoch 56: 9.001168251037598
Epoch: 57
[0/214] Loss: 8.9702
[43/214] Loss: 8.9413
[86/214] Loss: 8.9946
[129/214] Loss: 8.9909
[172/214] Loss: 8.9836
loss in epoch 57: 8.965473175048828
Epoch: 58
[0/214] Loss: 8.9134
[43/214] Loss: 8.9360
[86/214] Loss: 8.9913
[129/214] Loss: 9.0099
[172/214] Loss: 9.0277
loss in epoch 58: 8.909521102905273
Epoch: 59
[0/214] Loss: 8.9974
[43/214] Loss: 8.9863
[86/214] Loss: 8.9145
[129/214] Loss: 8.9586
[172/214] Loss: 9.0318
loss in epoch 59: 9.006568908691406
Epoch: 60
[0/214] Loss: 8.8983
[43/214] Loss: 8.9891
[86/214] Loss: 8.9786
[129/214] Loss: 9.0250
[172/214] Loss: 8.9297
loss in epoch 60: 8.905691146850586
start predicting:  2024-12-06 15:38:28.520954
{'Best_HR@5': 0.8537, 'Best_NDCG@5': 0.5377, 'Best_HR@10': 1.2546, 'Best_NDCG@10': 0.6812, 'Best_HR@20': 2.005, 'Best_NDCG@20': 0.8669}
{'Best_epoch_HR@5': 40, 'Best_epoch_NDCG@5': 60, 'Best_epoch_HR@10': 60, 'Best_epoch_NDCG@10': 60, 'Best_epoch_HR@20': 60, 'Best_epoch_NDCG@20': 60}
Epoch: 61
[0/214] Loss: 8.9056
[43/214] Loss: 8.8713
[86/214] Loss: 8.9454
[129/214] Loss: 8.9533
[172/214] Loss: 8.9741
loss in epoch 61: 8.876880645751953
Epoch: 62
[0/214] Loss: 8.9583
[43/214] Loss: 8.8776
[86/214] Loss: 9.0373
[129/214] Loss: 9.0104
[172/214] Loss: 8.9439
loss in epoch 62: 8.98051643371582
Epoch: 63
[0/214] Loss: 8.9678
[43/214] Loss: 8.9176
[86/214] Loss: 8.9494
[129/214] Loss: 9.0351
[172/214] Loss: 8.9457
loss in epoch 63: 8.970185279846191
Epoch: 64
[0/214] Loss: 8.9022
[43/214] Loss: 9.0509
[86/214] Loss: 8.9855
[129/214] Loss: 8.9720
[172/214] Loss: 8.9632
loss in epoch 64: 8.984832763671875
Epoch: 65
[0/214] Loss: 8.9584
[43/214] Loss: 8.9277
[86/214] Loss: 8.9210
[129/214] Loss: 8.9152
[172/214] Loss: 8.9291
loss in epoch 65: 8.826483726501465
Epoch: 66
[0/214] Loss: 8.9188
[43/214] Loss: 9.0031
[86/214] Loss: 9.0254
[129/214] Loss: 8.9233
[172/214] Loss: 8.9467
loss in epoch 66: 8.979387283325195
Epoch: 67
[0/214] Loss: 8.9647
[43/214] Loss: 8.9650
[86/214] Loss: 8.9965
[129/214] Loss: 8.8770
[172/214] Loss: 8.9899
loss in epoch 67: 9.000027656555176
Epoch: 68
[0/214] Loss: 8.9760
[43/214] Loss: 8.9587
[86/214] Loss: 8.9593
[129/214] Loss: 8.9388
[172/214] Loss: 8.9396
loss in epoch 68: 8.91505241394043
Epoch: 69
[0/214] Loss: 9.0014
[43/214] Loss: 8.9817
[86/214] Loss: 8.9983
[129/214] Loss: 8.9872
[172/214] Loss: 8.9173
loss in epoch 69: 8.95601749420166
Epoch: 70
[0/214] Loss: 8.9375
[43/214] Loss: 8.9757
[86/214] Loss: 8.9283
[129/214] Loss: 8.9486
[172/214] Loss: 8.9762
loss in epoch 70: 9.016573905944824
Epoch: 71
[0/214] Loss: 8.9450
[43/214] Loss: 8.9115
[86/214] Loss: 8.9593
[129/214] Loss: 8.9610
[172/214] Loss: 9.0295
loss in epoch 71: 8.842331886291504
Epoch: 72
[0/214] Loss: 8.9432
[43/214] Loss: 8.9270
[86/214] Loss: 8.9209
[129/214] Loss: 9.0310
[172/214] Loss: 8.9569
loss in epoch 72: 9.015737533569336
Epoch: 73
[0/214] Loss: 8.9387
[43/214] Loss: 8.9275
[86/214] Loss: 9.0222
[129/214] Loss: 8.9394
[172/214] Loss: 8.9598
loss in epoch 73: 8.950094223022461
Epoch: 74
[0/214] Loss: 8.9683
[43/214] Loss: 8.9369
[86/214] Loss: 8.9854
[129/214] Loss: 9.0132
[172/214] Loss: 8.9546
loss in epoch 74: 8.998871803283691
Epoch: 75
[0/214] Loss: 8.9973
[43/214] Loss: 9.0021
[86/214] Loss: 8.9487
[129/214] Loss: 8.9687
[172/214] Loss: 9.0048
loss in epoch 75: 9.004379272460938
Epoch: 76
[0/214] Loss: 8.9568
[43/214] Loss: 8.9710
[86/214] Loss: 8.9433
[129/214] Loss: 9.0084
[172/214] Loss: 8.9397
loss in epoch 76: 9.018571853637695
Epoch: 77
[0/214] Loss: 8.9219
[43/214] Loss: 8.9072
[86/214] Loss: 8.9125
[129/214] Loss: 8.9316
[172/214] Loss: 8.9705
loss in epoch 77: 8.970064163208008
Epoch: 78
[0/214] Loss: 8.9338
[43/214] Loss: 8.9777
[86/214] Loss: 8.9023
[129/214] Loss: 8.9177
[172/214] Loss: 8.9600
loss in epoch 78: 8.894932746887207
Epoch: 79
[0/214] Loss: 8.9611
[43/214] Loss: 8.9324
[86/214] Loss: 8.9176
[129/214] Loss: 8.9394
[172/214] Loss: 8.9763
loss in epoch 79: 8.998883247375488
Epoch: 80
[0/214] Loss: 8.9738
[43/214] Loss: 8.8539
[86/214] Loss: 8.8752
[129/214] Loss: 8.8042
[172/214] Loss: 8.6475
loss in epoch 80: 8.80494213104248
start predicting:  2024-12-06 16:36:51.413035
Epoch: 81
[0/214] Loss: 8.7029
[43/214] Loss: 8.6239
[86/214] Loss: 8.4114
[129/214] Loss: 8.4310
[172/214] Loss: 8.6066
loss in epoch 81: 8.349501609802246
Epoch: 82
[0/214] Loss: 8.3714
[43/214] Loss: 8.2033
[86/214] Loss: 8.2362
[129/214] Loss: 8.2118
[172/214] Loss: 8.2507
loss in epoch 82: 8.13172721862793
Epoch: 83
[0/214] Loss: 8.1632
[43/214] Loss: 8.0477
[86/214] Loss: 8.3313
[129/214] Loss: 8.0390
[172/214] Loss: 8.0402
loss in epoch 83: 8.031376838684082
Epoch: 84
[0/214] Loss: 7.9990
[43/214] Loss: 7.9043
[86/214] Loss: 8.1980
[129/214] Loss: 8.1063
[172/214] Loss: 7.9390
loss in epoch 84: 8.164223670959473
Epoch: 85
[0/214] Loss: 8.1144
[43/214] Loss: 7.8307
[86/214] Loss: 8.0896
[129/214] Loss: 8.2706
[172/214] Loss: 7.9885
loss in epoch 85: 7.984241962432861
Epoch: 86
[0/214] Loss: 8.0017
[43/214] Loss: 7.9831
[86/214] Loss: 7.9299
[129/214] Loss: 8.0170
[172/214] Loss: 8.2252
loss in epoch 86: 8.153404235839844
Epoch: 87
[0/214] Loss: 7.8841
[43/214] Loss: 7.8581
[86/214] Loss: 7.8644
[129/214] Loss: 7.8677
[172/214] Loss: 7.7839
loss in epoch 87: 7.7802734375
Epoch: 88
[0/214] Loss: 7.9656
[43/214] Loss: 7.9065
[86/214] Loss: 7.7862
[129/214] Loss: 7.9925
[172/214] Loss: 7.8610
loss in epoch 88: 7.856027603149414
Epoch: 89
[0/214] Loss: 8.1644
[43/214] Loss: 7.9567
[86/214] Loss: 8.0386
[129/214] Loss: 7.9824
[172/214] Loss: 7.8439
loss in epoch 89: 7.849974155426025
Epoch: 90
[0/214] Loss: 8.0907
[43/214] Loss: 7.7176
[86/214] Loss: 8.0054
[129/214] Loss: 7.9425
[172/214] Loss: 7.8626
loss in epoch 90: 7.866384029388428
Epoch: 91
[0/214] Loss: 7.8749
[43/214] Loss: 7.6599
[86/214] Loss: 7.7156
[129/214] Loss: 7.4794
[172/214] Loss: 7.8163
loss in epoch 91: 7.662671089172363
Epoch: 92
[0/214] Loss: 7.5855
[43/214] Loss: 7.7519
[86/214] Loss: 7.6732
[129/214] Loss: 7.8653
[172/214] Loss: 7.7583
loss in epoch 92: 7.957885265350342
Epoch: 93
[0/214] Loss: 8.0448
[43/214] Loss: 7.6989
[86/214] Loss: 7.6752
[129/214] Loss: 7.8225
[172/214] Loss: 7.7327
loss in epoch 93: 7.719057559967041
Epoch: 94
[0/214] Loss: 7.5549
[43/214] Loss: 7.7269
[86/214] Loss: 7.7970
[129/214] Loss: 7.7984
[172/214] Loss: 7.7713
loss in epoch 94: 7.761100769042969
Epoch: 95
[0/214] Loss: 7.5497
[43/214] Loss: 7.6319
[86/214] Loss: 7.6133
[129/214] Loss: 7.5603
[172/214] Loss: 7.7160
loss in epoch 95: 7.509649753570557
Epoch: 96
[0/214] Loss: 7.7877
[43/214] Loss: 7.5958
[86/214] Loss: 7.6577
[129/214] Loss: 7.7716
[172/214] Loss: 7.8170
loss in epoch 96: 7.567718982696533
Epoch: 97
[0/214] Loss: 7.5368
[43/214] Loss: 7.4840
[86/214] Loss: 7.6171
[129/214] Loss: 7.6114
[172/214] Loss: 7.5586
loss in epoch 97: 7.077177047729492
Epoch: 98
[0/214] Loss: 7.5433
[43/214] Loss: 7.4916
[86/214] Loss: 7.5615
[129/214] Loss: 7.6476
[172/214] Loss: 7.4631
loss in epoch 98: 7.453390598297119
Epoch: 99
[0/214] Loss: 7.5379
[43/214] Loss: 7.6364
[86/214] Loss: 7.6163
[129/214] Loss: 7.3818
[172/214] Loss: 7.3864
loss in epoch 99: 7.313501358032227
Epoch: 100
[0/214] Loss: 7.6779
[43/214] Loss: 7.5814
[86/214] Loss: 7.5823
[129/214] Loss: 7.6260
[172/214] Loss: 7.5900
loss in epoch 100: 7.459296703338623
start predicting:  2024-12-06 17:41:44.877777
Epoch: 101
[0/214] Loss: 7.5427
[43/214] Loss: 7.6485
[86/214] Loss: 7.3416
[129/214] Loss: 7.3279
[172/214] Loss: 7.4246
loss in epoch 101: 7.602123737335205
Epoch: 102
[0/214] Loss: 7.3023
[43/214] Loss: 7.5578
[86/214] Loss: 7.6757
[129/214] Loss: 7.5449
[172/214] Loss: 7.5489
loss in epoch 102: 7.6806111335754395
Epoch: 103
[0/214] Loss: 7.6013
[43/214] Loss: 7.7229
[86/214] Loss: 7.6736
[129/214] Loss: 7.6257
[172/214] Loss: 7.6052
loss in epoch 103: 7.654300212860107
Epoch: 104
[0/214] Loss: 7.6650
[43/214] Loss: 7.5864
[86/214] Loss: 7.7060
[129/214] Loss: 7.4449
[172/214] Loss: 7.4336
loss in epoch 104: 7.340038299560547
Epoch: 105
[0/214] Loss: 7.2130
[43/214] Loss: 7.3313
[86/214] Loss: 7.4038
[129/214] Loss: 7.5198
[172/214] Loss: 7.2464
loss in epoch 105: 7.3917927742004395
Epoch: 106
[0/214] Loss: 7.3472
[43/214] Loss: 7.3658
[86/214] Loss: 7.4584
[129/214] Loss: 7.6492
[172/214] Loss: 7.5162
loss in epoch 106: 7.761201858520508
Epoch: 107
[0/214] Loss: 7.5478
[43/214] Loss: 7.5135
[86/214] Loss: 7.4988
[129/214] Loss: 7.4334
[172/214] Loss: 7.3775
loss in epoch 107: 7.833303928375244
Epoch: 108
[0/214] Loss: 7.6658
[43/214] Loss: 7.7368
[86/214] Loss: 7.3794
[129/214] Loss: 7.6369
[172/214] Loss: 7.3601
loss in epoch 108: 7.386959075927734
Epoch: 109
[0/214] Loss: 7.6727
[43/214] Loss: 7.3633
[86/214] Loss: 7.6595
[129/214] Loss: 7.2228
[172/214] Loss: 7.6588
loss in epoch 109: 7.737269401550293
Epoch: 110
[0/214] Loss: 7.3936
[43/214] Loss: 7.3077
[86/214] Loss: 7.6642
[129/214] Loss: 7.5473
[172/214] Loss: 7.4006
loss in epoch 110: 7.492007255554199
Epoch: 111
[0/214] Loss: 7.4863
[43/214] Loss: 7.6392
[86/214] Loss: 7.4810
[129/214] Loss: 7.3258
[172/214] Loss: 7.5019
loss in epoch 111: 7.56015157699585
Epoch: 112
[0/214] Loss: 7.5372
[43/214] Loss: 7.5622
[86/214] Loss: 7.4112
[129/214] Loss: 7.4859
[172/214] Loss: 7.4059
loss in epoch 112: 7.244864463806152
Epoch: 113
[0/214] Loss: 7.7901
[43/214] Loss: 7.4638
[86/214] Loss: 7.7035
[129/214] Loss: 7.4188
[172/214] Loss: 7.6155
loss in epoch 113: 7.637399196624756
Epoch: 114
[0/214] Loss: 7.5335
[43/214] Loss: 7.3008
[86/214] Loss: 7.6508
[129/214] Loss: 7.5163
[172/214] Loss: 7.4335
loss in epoch 114: 7.491155624389648
Epoch: 115
[0/214] Loss: 7.5882
[43/214] Loss: 7.4187
[86/214] Loss: 7.5938
[129/214] Loss: 7.4610
[172/214] Loss: 7.5700
loss in epoch 115: 7.548950672149658
Epoch: 116
[0/214] Loss: 7.4631
[43/214] Loss: 7.4118
[86/214] Loss: 7.3284
[129/214] Loss: 7.6447
[172/214] Loss: 7.4032
loss in epoch 116: 7.408184051513672
Epoch: 117
[0/214] Loss: 7.3176
[43/214] Loss: 7.5259
[86/214] Loss: 7.3349
[129/214] Loss: 7.5598
[172/214] Loss: 7.5982
loss in epoch 117: 7.359245300292969
Epoch: 118
[0/214] Loss: 7.4001
[43/214] Loss: 7.5743
[86/214] Loss: 7.4694
[129/214] Loss: 7.4328
[172/214] Loss: 7.2896
loss in epoch 118: 7.128052234649658
Epoch: 119
[0/214] Loss: 7.2809
[43/214] Loss: 7.4863
[86/214] Loss: 7.0794
[129/214] Loss: 7.4877
[172/214] Loss: 7.3307
loss in epoch 119: 7.272951602935791
Epoch: 120
[0/214] Loss: 7.5994
[43/214] Loss: 7.3762
[86/214] Loss: 7.1625
[129/214] Loss: 7.4818
[172/214] Loss: 7.2721
loss in epoch 120: 7.326938629150391
start predicting:  2024-12-06 18:54:19.552469
Epoch: 121
[0/214] Loss: 7.3280
[43/214] Loss: 7.4968
[86/214] Loss: 7.5109
[129/214] Loss: 7.2487
[172/214] Loss: 7.5196
loss in epoch 121: 7.621908664703369
Epoch: 122
[0/214] Loss: 7.3598
[43/214] Loss: 7.5483
[86/214] Loss: 7.4681
[129/214] Loss: 7.6544
[172/214] Loss: 7.6162
loss in epoch 122: 7.35777473449707
Epoch: 123
[0/214] Loss: 7.3916
[43/214] Loss: 7.3474
[86/214] Loss: 7.3260
[129/214] Loss: 7.4651
[172/214] Loss: 7.5209
loss in epoch 123: 7.579786777496338
Epoch: 124
[0/214] Loss: 7.4199
[43/214] Loss: 7.2375
[86/214] Loss: 7.3550
[129/214] Loss: 7.5878
[172/214] Loss: 7.3419
loss in epoch 124: 7.397897243499756
Epoch: 125
[0/214] Loss: 7.4085
[43/214] Loss: 7.5634
[86/214] Loss: 7.7113
[129/214] Loss: 7.3095
[172/214] Loss: 7.2797
loss in epoch 125: 7.327622890472412
Epoch: 126
[0/214] Loss: 7.5243
[43/214] Loss: 7.2807
[86/214] Loss: 7.4358
[129/214] Loss: 7.2535
[172/214] Loss: 7.3742
loss in epoch 126: 7.497851371765137
Epoch: 127
[0/214] Loss: 7.3778
[43/214] Loss: 7.4127
[86/214] Loss: 7.2738
[129/214] Loss: 7.2035
[172/214] Loss: 7.3094
loss in epoch 127: 7.200680255889893
Epoch: 128
[0/214] Loss: 7.4563
[43/214] Loss: 7.7711
[86/214] Loss: 7.4375
[129/214] Loss: 7.1564
[172/214] Loss: 7.6430
loss in epoch 128: 7.228310585021973
Epoch: 129
[0/214] Loss: 7.4774
[43/214] Loss: 7.3078
[86/214] Loss: 7.5238
[129/214] Loss: 7.3770
[172/214] Loss: 7.4799
loss in epoch 129: 7.246787071228027
Epoch: 130
[0/214] Loss: 7.2529
[43/214] Loss: 7.1532
[86/214] Loss: 7.5315
[129/214] Loss: 7.3774
[172/214] Loss: 7.2481
loss in epoch 130: 7.693093776702881
Epoch: 131
[0/214] Loss: 7.4724
[43/214] Loss: 7.4694
[86/214] Loss: 7.3656
[129/214] Loss: 7.1988
[172/214] Loss: 7.2667
loss in epoch 131: 7.5864081382751465
Epoch: 132
[0/214] Loss: 7.3875
[43/214] Loss: 7.3597
[86/214] Loss: 7.4905
[129/214] Loss: 7.4424
[172/214] Loss: 7.5147
loss in epoch 132: 7.407023906707764
Epoch: 133
[0/214] Loss: 7.5113
[43/214] Loss: 7.3293
[86/214] Loss: 7.3171
[129/214] Loss: 7.2283
[172/214] Loss: 7.3745
loss in epoch 133: 7.057381629943848
Epoch: 134
[0/214] Loss: 7.3923
[43/214] Loss: 7.2026
[86/214] Loss: 7.4874
[129/214] Loss: 7.2520
[172/214] Loss: 7.3528
loss in epoch 134: 7.57170295715332
Epoch: 135
[0/214] Loss: 7.4451
[43/214] Loss: 7.3322
[86/214] Loss: 7.4895
[129/214] Loss: 7.3583
[172/214] Loss: 7.5049
loss in epoch 135: 7.251062870025635
Epoch: 136
[0/214] Loss: 7.3026
[43/214] Loss: 7.5000
[86/214] Loss: 7.1865
[129/214] Loss: 7.4191
[172/214] Loss: 7.3592
loss in epoch 136: 7.565931797027588
Epoch: 137
[0/214] Loss: 7.3258
[43/214] Loss: 7.4911
[86/214] Loss: 7.5514
[129/214] Loss: 7.4448
[172/214] Loss: 7.5439
loss in epoch 137: 7.194275856018066
Epoch: 138
[0/214] Loss: 7.5369
[43/214] Loss: 7.2631
[86/214] Loss: 7.4176
[129/214] Loss: 7.5104
[172/214] Loss: 7.2809
loss in epoch 138: 7.250757217407227
Epoch: 139
[0/214] Loss: 7.4661
[43/214] Loss: 7.1501
[86/214] Loss: 7.2312
[129/214] Loss: 7.3374
[172/214] Loss: 7.1902
loss in epoch 139: 7.620331764221191
Epoch: 140
[0/214] Loss: 7.4581
[43/214] Loss: 7.2329
[86/214] Loss: 7.3768
[129/214] Loss: 7.4548
[172/214] Loss: 7.4592
loss in epoch 140: 7.4694342613220215
start predicting:  2024-12-06 20:13:40.277214
Epoch: 141
[0/214] Loss: 7.1008
[43/214] Loss: 7.4033
[86/214] Loss: 7.2187
[129/214] Loss: 7.3786
[172/214] Loss: 7.2678
loss in epoch 141: 7.3576860427856445
Epoch: 142
[0/214] Loss: 7.4285
[43/214] Loss: 7.4711
[86/214] Loss: 7.3315
[129/214] Loss: 7.5380
[172/214] Loss: 7.5319
loss in epoch 142: 7.157582759857178
Epoch: 143
[0/214] Loss: 7.2697
[43/214] Loss: 7.2731
[86/214] Loss: 7.4663
[129/214] Loss: 7.4024
[172/214] Loss: 7.6737
loss in epoch 143: 7.466543197631836
Epoch: 144
[0/214] Loss: 7.3475
[43/214] Loss: 7.3862
[86/214] Loss: 7.4524
[129/214] Loss: 7.3129
[172/214] Loss: 7.4339
loss in epoch 144: 7.665975570678711
Epoch: 145
[0/214] Loss: 7.5009
[43/214] Loss: 7.3589
[86/214] Loss: 7.4608
[129/214] Loss: 7.1805
[172/214] Loss: 7.4618
loss in epoch 145: 7.06716251373291
Epoch: 146
[0/214] Loss: 7.5386
[43/214] Loss: 7.1691
[86/214] Loss: 7.1182
[129/214] Loss: 7.2589
[172/214] Loss: 7.6454
loss in epoch 146: 7.321782112121582
Epoch: 147
[0/214] Loss: 7.3637
[43/214] Loss: 7.4842
[86/214] Loss: 7.3374
[129/214] Loss: 7.3056
[172/214] Loss: 7.1498
loss in epoch 147: 7.474543571472168
Epoch: 148
[0/214] Loss: 7.4407
[43/214] Loss: 7.5160
[86/214] Loss: 7.3652
[129/214] Loss: 7.3069
[172/214] Loss: 7.3498
loss in epoch 148: 7.065511226654053
Epoch: 149
[0/214] Loss: 7.2421
[43/214] Loss: 7.2358
[86/214] Loss: 7.4770
[129/214] Loss: 7.5238
[172/214] Loss: 7.2482
loss in epoch 149: 7.218457221984863
Epoch: 150
[0/214] Loss: 7.4217
[43/214] Loss: 7.5735
[86/214] Loss: 7.3077
[129/214] Loss: 7.3739
[172/214] Loss: 7.2860
loss in epoch 150: 7.325438022613525
Epoch: 151
[0/214] Loss: 7.2455
[43/214] Loss: 7.2079
[86/214] Loss: 7.3175
[129/214] Loss: 7.0693
[172/214] Loss: 7.0530
loss in epoch 151: 7.662785053253174
Epoch: 152
[0/214] Loss: 7.1826
[43/214] Loss: 7.4527
[86/214] Loss: 7.4993
[129/214] Loss: 7.3089
[172/214] Loss: 7.6144
loss in epoch 152: 7.358312129974365
Epoch: 153
[0/214] Loss: 7.4613
[43/214] Loss: 7.3989
[86/214] Loss: 7.5684
[129/214] Loss: 7.5620
[172/214] Loss: 7.2826
loss in epoch 153: 7.14149284362793
Epoch: 154
[0/214] Loss: 7.7683
[43/214] Loss: 7.4473
[86/214] Loss: 7.0120
[129/214] Loss: 7.2712
[172/214] Loss: 7.5024
loss in epoch 154: 7.428384304046631
Epoch: 155
[0/214] Loss: 7.4058
[43/214] Loss: 7.4315
[86/214] Loss: 7.2303
[129/214] Loss: 7.4264
[172/214] Loss: 7.4147
loss in epoch 155: 7.246833324432373
Epoch: 156
[0/214] Loss: 7.3017
[43/214] Loss: 7.4258
[86/214] Loss: 7.4390
[129/214] Loss: 7.4764
[172/214] Loss: 7.3902
loss in epoch 156: 7.094583511352539
Epoch: 157
[0/214] Loss: 7.3042
[43/214] Loss: 7.6762
[86/214] Loss: 7.3432
[129/214] Loss: 7.2610
[172/214] Loss: 7.2703
loss in epoch 157: 7.2030463218688965
Epoch: 158
[0/214] Loss: 7.1839
[43/214] Loss: 7.3693
[86/214] Loss: 7.4465
[129/214] Loss: 7.4527
[172/214] Loss: 7.3313
loss in epoch 158: 7.352378845214844
Epoch: 159
[0/214] Loss: 7.3066
[43/214] Loss: 7.0089
[86/214] Loss: 7.1843
[129/214] Loss: 7.3149
[172/214] Loss: 7.3214
loss in epoch 159: 7.525084018707275
Epoch: 160
[0/214] Loss: 7.2542
[43/214] Loss: 7.2312
[86/214] Loss: 7.3173
[129/214] Loss: 7.3839
[172/214] Loss: 7.2161
loss in epoch 160: 7.379875659942627
start predicting:  2024-12-06 21:25:02.417834
Test------------------------------------------------------
{'HR@5': 0.0257, 'NDCG@5': 0.0209, 'HR@10': 0.0668, 'NDCG@10': 0.0341, 'HR@20': 0.1182, 'NDCG@20': 0.0463}
Best Eval---------------------------------------------------------
{'Best_HR@5': 0.8537, 'Best_NDCG@5': 0.5377, 'Best_HR@10': 1.2546, 'Best_NDCG@10': 0.6812, 'Best_HR@20': 2.005, 'Best_NDCG@20': 0.8669}
{'Best_epoch_HR@5': 40, 'Best_epoch_NDCG@5': 60, 'Best_epoch_HR@10': 60, 'Best_epoch_NDCG@10': 60, 'Best_epoch_HR@20': 60, 'Best_epoch_NDCG@20': 60}
Namespace(batch_size=512, dataset='toys', decay_step=100, description='Diffu_norm_score', device='cuda', diffusion_steps=32, diversity_measure=False, dropout=0.1, emb_dropout=0.3, epoch_time_avg=False, epochs=500, eval_interval=20, gamma=0.1, hidden_act='gelu', hidden_size=128, item_num=11924, lambda_uncertainty=0.001, log_file='log/', long_head=False, loss_lambda=0.001, lr=0.001, max_len=50, metric_ks=[5, 10, 20], momentum=None, noise_schedule='trunc_lin', num_blocks=4, num_gpu=1, optimizer='Adam', patience=5, random_seed=1997, rescale_timesteps=True, schedule_sampler_name='lossaware', weight_decay=0)
