nohup: ignoring input
Namespace(batch_size=512, dataset='toys', decay_step=100, description='Diffu_norm_score', device='cuda', diffusion_steps=32, diversity_measure=False, dropout=0.1, emb_dropout=0.3, epoch_time_avg=False, epochs=500, eval_interval=20, gamma=0.1, hidden_act='gelu', hidden_size=128, lambda_uncertainty=0.001, log_file='log/', long_head=False, loss_lambda=0.001, lr=0.001, max_len=50, metric_ks=[5, 10, 20], momentum=None, noise_schedule='trunc_lin', num_blocks=4, num_gpu=1, optimizer='Adam', patience=5, random_seed=1997, rescale_timesteps=True, schedule_sampler_name='lossaware', weight_decay=0)
Epoch: 0
[0/214] Loss: 40.4172
[43/214] Loss: 37.2720
[86/214] Loss: 35.3826
[129/214] Loss: 32.8516
[172/214] Loss: 31.4626
loss in epoch 0: 29.542245864868164
Epoch: 1
[0/214] Loss: 30.0189
[43/214] Loss: 27.8840
[86/214] Loss: 26.0167
[129/214] Loss: 24.0301
[172/214] Loss: 20.5380
loss in epoch 1: 16.492446899414062
Epoch: 2
[0/214] Loss: 16.2612
[43/214] Loss: 13.9673
[86/214] Loss: 12.0433
[129/214] Loss: 10.9316
[172/214] Loss: 10.4495
loss in epoch 2: 10.286201477050781
Epoch: 3
[0/214] Loss: 10.3396
[43/214] Loss: 9.8709
[86/214] Loss: 9.9756
[129/214] Loss: 9.7795
[172/214] Loss: 9.7275
loss in epoch 3: 9.88927173614502
Epoch: 4
[0/214] Loss: 9.6736
[43/214] Loss: 9.7411
[86/214] Loss: 9.6676
[129/214] Loss: 9.5476
[172/214] Loss: 9.4998
loss in epoch 4: 9.511897087097168
Epoch: 5
[0/214] Loss: 9.5049
[43/214] Loss: 9.5467
[86/214] Loss: 9.5051
[129/214] Loss: 9.5175
[172/214] Loss: 9.4560
loss in epoch 5: 9.383119583129883
Epoch: 6
[0/214] Loss: 9.4582
[43/214] Loss: 9.4045
[86/214] Loss: 9.3953
[129/214] Loss: 9.3973
[172/214] Loss: 9.4110
loss in epoch 6: 9.351746559143066
Epoch: 7
[0/214] Loss: 9.3427
[43/214] Loss: 9.3357
[86/214] Loss: 9.3584
[129/214] Loss: 9.3094
[172/214] Loss: 9.3129
loss in epoch 7: 9.37138557434082
Epoch: 8
[0/214] Loss: 9.2639
[43/214] Loss: 9.3149
[86/214] Loss: 9.2900
[129/214] Loss: 9.2571
[172/214] Loss: 9.3185
loss in epoch 8: 9.250484466552734
Epoch: 9
[0/214] Loss: 9.2513
[43/214] Loss: 9.2249
[86/214] Loss: 9.2619
[129/214] Loss: 9.1739
[172/214] Loss: 9.2146
loss in epoch 9: 9.148439407348633
Epoch: 10
[0/214] Loss: 9.1397
[43/214] Loss: 9.2160
[86/214] Loss: 9.1637
[129/214] Loss: 9.1598
[172/214] Loss: 9.1451
loss in epoch 10: 9.134692192077637
Epoch: 11
[0/214] Loss: 9.1801
[43/214] Loss: 9.1261
[86/214] Loss: 9.1421
[129/214] Loss: 9.0213
[172/214] Loss: 9.1705
loss in epoch 11: 9.214273452758789
Epoch: 12
[0/214] Loss: 9.1940
[43/214] Loss: 9.0500
[86/214] Loss: 9.0513
[129/214] Loss: 9.0265
[172/214] Loss: 8.9957
loss in epoch 12: 9.08788013458252
Epoch: 13
[0/214] Loss: 9.0782
[43/214] Loss: 9.0671
[86/214] Loss: 8.9923
[129/214] Loss: 8.9983
[172/214] Loss: 8.9456
loss in epoch 13: 9.063453674316406
Epoch: 14
[0/214] Loss: 8.9814
[43/214] Loss: 9.0656
[86/214] Loss: 8.9856
[129/214] Loss: 8.9299
[172/214] Loss: 9.0512
loss in epoch 14: 9.008793830871582
Epoch: 15
[0/214] Loss: 8.9586
[43/214] Loss: 9.0307
[86/214] Loss: 8.9701
[129/214] Loss: 8.9438
[172/214] Loss: 9.0763
loss in epoch 15: 9.055512428283691
Epoch: 16
[0/214] Loss: 8.9987
[43/214] Loss: 8.9724
[86/214] Loss: 8.9876
[129/214] Loss: 8.9423
[172/214] Loss: 8.9502
loss in epoch 16: 8.988959312438965
Epoch: 17
[0/214] Loss: 8.9308
[43/214] Loss: 8.9857
[86/214] Loss: 8.9049
[129/214] Loss: 9.0795
[172/214] Loss: 8.9749
loss in epoch 17: 8.966874122619629
Epoch: 18
[0/214] Loss: 8.9235
[43/214] Loss: 9.0068
[86/214] Loss: 8.9896
[129/214] Loss: 8.9633
[172/214] Loss: 8.9006
loss in epoch 18: 8.924388885498047
Epoch: 19
[0/214] Loss: 8.8960
[43/214] Loss: 8.9233
[86/214] Loss: 8.9734
[129/214] Loss: 8.9430
[172/214] Loss: 8.9050
loss in epoch 19: 9.077093124389648
Epoch: 20
[0/214] Loss: 8.9240
[43/214] Loss: 8.9737
[86/214] Loss: 8.8743
[129/214] Loss: 8.8086
[172/214] Loss: 8.8705
loss in epoch 20: 9.020899772644043
start predicting:  2024-12-06 11:15:44.729961
{'Best_HR@5': 0.8177, 'Best_NDCG@5': 0.48, 'Best_HR@10': 1.2083, 'Best_NDCG@10': 0.6034, 'Best_HR@20': 1.9074, 'Best_NDCG@20': 0.7782}
{'Best_epoch_HR@5': 20, 'Best_epoch_NDCG@5': 20, 'Best_epoch_HR@10': 20, 'Best_epoch_NDCG@10': 20, 'Best_epoch_HR@20': 20, 'Best_epoch_NDCG@20': 20}
Epoch: 21
[0/214] Loss: 8.9291
[43/214] Loss: 8.9768
[86/214] Loss: 8.9470
[129/214] Loss: 8.9774
[172/214] Loss: 8.9562
loss in epoch 21: 8.883967399597168
Epoch: 22
[0/214] Loss: 8.9909
[43/214] Loss: 8.9787
[86/214] Loss: 9.0267
[129/214] Loss: 9.0318
[172/214] Loss: 8.9529
loss in epoch 22: 8.894058227539062
Epoch: 23
[0/214] Loss: 8.9997
[43/214] Loss: 8.8983
[86/214] Loss: 8.9722
[129/214] Loss: 8.9621
[172/214] Loss: 9.0250
loss in epoch 23: 8.991850852966309
Epoch: 24
[0/214] Loss: 8.9844
[43/214] Loss: 8.9984
[86/214] Loss: 8.9408
[129/214] Loss: 8.9744
[172/214] Loss: 8.9914
loss in epoch 24: 8.966172218322754
Epoch: 25
[0/214] Loss: 8.9458
[43/214] Loss: 8.8895
[86/214] Loss: 8.9097
[129/214] Loss: 8.9305
[172/214] Loss: 8.9147
loss in epoch 25: 9.163745880126953
Epoch: 26
[0/214] Loss: 9.0625
[43/214] Loss: 9.0188
[86/214] Loss: 9.0999
[129/214] Loss: 8.9120
[172/214] Loss: 9.0025
loss in epoch 26: 9.03207778930664
Epoch: 27
[0/214] Loss: 8.9647
[43/214] Loss: 8.9367
[86/214] Loss: 8.8951
[129/214] Loss: 8.9511
[172/214] Loss: 8.9524
loss in epoch 27: 9.037365913391113
Epoch: 28
[0/214] Loss: 8.9703
[43/214] Loss: 8.9014
[86/214] Loss: 9.0165
[129/214] Loss: 9.0338
[172/214] Loss: 9.0200
loss in epoch 28: 8.855297088623047
Epoch: 29
[0/214] Loss: 8.9524
[43/214] Loss: 8.9894
[86/214] Loss: 8.9609
[129/214] Loss: 8.9722
[172/214] Loss: 8.9637
loss in epoch 29: 8.93995475769043
Epoch: 30
[0/214] Loss: 8.9900
[43/214] Loss: 8.9211
[86/214] Loss: 8.9915
[129/214] Loss: 9.0178
[172/214] Loss: 9.1026
loss in epoch 30: 8.954887390136719
Epoch: 31
[0/214] Loss: 8.8602
[43/214] Loss: 8.9383
[86/214] Loss: 8.9700
[129/214] Loss: 8.9256
[172/214] Loss: 9.0080
loss in epoch 31: 9.024360656738281
Epoch: 32
[0/214] Loss: 8.9026
[43/214] Loss: 8.9678
[86/214] Loss: 8.9764
[129/214] Loss: 9.0024
[172/214] Loss: 9.0301
loss in epoch 32: 8.928570747375488
Epoch: 33
[0/214] Loss: 8.8720
[43/214] Loss: 8.9479
[86/214] Loss: 8.9105
[129/214] Loss: 8.9953
[172/214] Loss: 8.9034
loss in epoch 33: 8.961424827575684
Epoch: 34
[0/214] Loss: 8.9074
[43/214] Loss: 8.9878
[86/214] Loss: 8.8443
[129/214] Loss: 8.9197
[172/214] Loss: 8.9824
loss in epoch 34: 8.938289642333984
Epoch: 35
[0/214] Loss: 8.8915
[43/214] Loss: 8.9344
[86/214] Loss: 8.9666
[129/214] Loss: 8.9391
[172/214] Loss: 8.9979
loss in epoch 35: 8.958354949951172
Epoch: 36
[0/214] Loss: 8.8875
[43/214] Loss: 8.9611
[86/214] Loss: 8.9842
[129/214] Loss: 8.9584
[172/214] Loss: 9.0492
loss in epoch 36: 8.988693237304688
Epoch: 37
[0/214] Loss: 8.9070
[43/214] Loss: 8.9391
[86/214] Loss: 8.9613
[129/214] Loss: 8.8983
[172/214] Loss: 9.0112
loss in epoch 37: 9.026898384094238
Epoch: 38
[0/214] Loss: 9.0123
[43/214] Loss: 8.8214
[86/214] Loss: 8.9385
[129/214] Loss: 8.9878
[172/214] Loss: 8.8879
loss in epoch 38: 9.040854454040527
Epoch: 39
[0/214] Loss: 9.0282
[43/214] Loss: 8.9480
[86/214] Loss: 8.9257
[129/214] Loss: 8.9116
[172/214] Loss: 8.9771
loss in epoch 39: 9.017690658569336
Epoch: 40
[0/214] Loss: 8.8658
[43/214] Loss: 8.9094
[86/214] Loss: 8.8166
[129/214] Loss: 9.0047
[172/214] Loss: 8.9824
loss in epoch 40: 9.023560523986816
start predicting:  2024-12-06 11:24:45.715273
{'Best_HR@5': 0.8331, 'Best_NDCG@5': 0.5418, 'Best_HR@10': 1.2289, 'Best_NDCG@10': 0.6713, 'Best_HR@20': 1.9074, 'Best_NDCG@20': 0.8295}
{'Best_epoch_HR@5': 40, 'Best_epoch_NDCG@5': 40, 'Best_epoch_HR@10': 40, 'Best_epoch_NDCG@10': 40, 'Best_epoch_HR@20': 20, 'Best_epoch_NDCG@20': 40}
Epoch: 41
[0/214] Loss: 8.9817
[43/214] Loss: 8.9505
[86/214] Loss: 8.9053
[129/214] Loss: 8.9467
[172/214] Loss: 8.9473
loss in epoch 41: 8.967084884643555
Epoch: 42
[0/214] Loss: 8.9463
[43/214] Loss: 8.9964
[86/214] Loss: 9.0898
[129/214] Loss: 8.9485
[172/214] Loss: 8.9964
loss in epoch 42: 8.952128410339355
Epoch: 43
[0/214] Loss: 8.8897
[43/214] Loss: 8.9557
[86/214] Loss: 8.9550
[129/214] Loss: 8.9458
[172/214] Loss: 9.0078
loss in epoch 43: 8.962108612060547
Epoch: 44
[0/214] Loss: 8.9524
[43/214] Loss: 8.9775
[86/214] Loss: 8.8959
[129/214] Loss: 8.9263
[172/214] Loss: 8.9607
loss in epoch 44: 9.066276550292969
Epoch: 45
[0/214] Loss: 8.9990
[43/214] Loss: 8.9598
[86/214] Loss: 8.9507
[129/214] Loss: 8.9435
[172/214] Loss: 8.9558
loss in epoch 45: 8.962822914123535
Epoch: 46
[0/214] Loss: 8.9430
[43/214] Loss: 8.9206
[86/214] Loss: 8.9752
[129/214] Loss: 8.9343
[172/214] Loss: 8.9440
loss in epoch 46: 9.015408515930176
Epoch: 47
[0/214] Loss: 8.9165
[43/214] Loss: 8.9725
[86/214] Loss: 8.8464
[129/214] Loss: 8.9816
[172/214] Loss: 8.9734
loss in epoch 47: 8.95188045501709
Epoch: 48
[0/214] Loss: 8.9553
[43/214] Loss: 8.9189
[86/214] Loss: 8.9538
[129/214] Loss: 8.9095
[172/214] Loss: 8.9751
loss in epoch 48: 8.975358963012695
Epoch: 49
[0/214] Loss: 8.9760
[43/214] Loss: 8.9425
[86/214] Loss: 8.9975
[129/214] Loss: 8.9341
[172/214] Loss: 8.8974
loss in epoch 49: 9.019937515258789
Epoch: 50
[0/214] Loss: 8.8896
[43/214] Loss: 8.9213
[86/214] Loss: 8.9126
[129/214] Loss: 8.8913
[172/214] Loss: 8.9055
loss in epoch 50: 8.830480575561523
Epoch: 51
[0/214] Loss: 8.9496
[43/214] Loss: 8.8279
[86/214] Loss: 8.9149
[129/214] Loss: 8.8540
[172/214] Loss: 8.9508
loss in epoch 51: 8.831149101257324
Epoch: 52
[0/214] Loss: 8.8586
[43/214] Loss: 8.8369
[86/214] Loss: 8.7673
[129/214] Loss: 8.8372
[172/214] Loss: 8.8597
loss in epoch 52: 8.882332801818848
Epoch: 53
[0/214] Loss: 8.7830
[43/214] Loss: 8.8107
[86/214] Loss: 8.7067
[129/214] Loss: 8.6895
[172/214] Loss: 8.7263
loss in epoch 53: 8.640414237976074
Epoch: 54
[0/214] Loss: 8.6874
[43/214] Loss: 8.6094
[86/214] Loss: 8.5276
[129/214] Loss: 8.6529
[172/214] Loss: 8.5256
loss in epoch 54: 8.35689640045166
Epoch: 55
[0/214] Loss: 8.4477
[43/214] Loss: 8.3557
[86/214] Loss: 8.4324
[129/214] Loss: 8.3871
[172/214] Loss: 8.3069
loss in epoch 55: 8.243208885192871
Epoch: 56
[0/214] Loss: 8.3048
[43/214] Loss: 8.3536
[86/214] Loss: 8.3433
[129/214] Loss: 8.1962
[172/214] Loss: 8.2864
loss in epoch 56: 7.989498138427734
Epoch: 57
[0/214] Loss: 8.2136
[43/214] Loss: 8.0784
[86/214] Loss: 8.2015
[129/214] Loss: 8.0996
[172/214] Loss: 8.2916
loss in epoch 57: 8.285293579101562
Epoch: 58
[0/214] Loss: 8.1305
[43/214] Loss: 8.0943
[86/214] Loss: 8.3426
[129/214] Loss: 8.3137
[172/214] Loss: 8.2290
loss in epoch 58: 8.411088943481445
Epoch: 59
[0/214] Loss: 8.0573
[43/214] Loss: 8.0264
[86/214] Loss: 8.0539
[129/214] Loss: 8.0971
[172/214] Loss: 8.0691
loss in epoch 59: 7.9131269454956055
Epoch: 60
[0/214] Loss: 7.9693
[43/214] Loss: 8.0578
[86/214] Loss: 8.0081
[129/214] Loss: 7.8471
[172/214] Loss: 7.7991
loss in epoch 60: 8.041112899780273
start predicting:  2024-12-06 11:33:46.917506
Epoch: 61
[0/214] Loss: 7.8891
[43/214] Loss: 8.0217
[86/214] Loss: 7.8315
[129/214] Loss: 7.9982
[172/214] Loss: 7.8364
loss in epoch 61: 8.192835807800293
Epoch: 62
[0/214] Loss: 7.9767
[43/214] Loss: 7.9617
[86/214] Loss: 7.8051
[129/214] Loss: 8.0079
[172/214] Loss: 7.7732
loss in epoch 62: 7.729536056518555
Epoch: 63
[0/214] Loss: 7.8972
[43/214] Loss: 7.8983
[86/214] Loss: 7.9255
[129/214] Loss: 7.8490
[172/214] Loss: 7.7832
loss in epoch 63: 7.940621852874756
Epoch: 64
[0/214] Loss: 7.8592
[43/214] Loss: 7.5906
[86/214] Loss: 7.7818
[129/214] Loss: 7.5291
[172/214] Loss: 7.7915
loss in epoch 64: 7.756153106689453
Epoch: 65
[0/214] Loss: 7.9056
[43/214] Loss: 7.8604
[86/214] Loss: 7.6445
[129/214] Loss: 7.7107
[172/214] Loss: 7.6311
loss in epoch 65: 7.803380966186523
Epoch: 66
[0/214] Loss: 7.8999
[43/214] Loss: 7.5766
[86/214] Loss: 7.8202
[129/214] Loss: 7.6153
[172/214] Loss: 7.9580
loss in epoch 66: 7.735790252685547
Epoch: 67
[0/214] Loss: 7.6473
[43/214] Loss: 7.6832
[86/214] Loss: 7.7183
[129/214] Loss: 7.5472
[172/214] Loss: 7.6156
loss in epoch 67: 7.505159854888916
Epoch: 68
[0/214] Loss: 7.4934
[43/214] Loss: 7.7177
[86/214] Loss: 7.6827
[129/214] Loss: 7.5377
[172/214] Loss: 7.5047
loss in epoch 68: 7.5974931716918945
Epoch: 69
[0/214] Loss: 7.5156
[43/214] Loss: 7.6209
[86/214] Loss: 7.3882
[129/214] Loss: 7.4297
[172/214] Loss: 7.7342
loss in epoch 69: 7.393733978271484
Epoch: 70
[0/214] Loss: 7.4414
[43/214] Loss: 7.7368
[86/214] Loss: 7.5976
[129/214] Loss: 7.6940
[172/214] Loss: 7.4306
loss in epoch 70: 7.782191276550293
Epoch: 71
[0/214] Loss: 7.4262
[43/214] Loss: 7.5034
[86/214] Loss: 7.7837
[129/214] Loss: 7.4491
[172/214] Loss: 7.4859
loss in epoch 71: 7.52825927734375
Epoch: 72
[0/214] Loss: 7.4523
[43/214] Loss: 7.3358
[86/214] Loss: 7.3582
[129/214] Loss: 7.6321
[172/214] Loss: 7.2233
loss in epoch 72: 7.502943515777588
Epoch: 73
[0/214] Loss: 7.3453
[43/214] Loss: 7.6222
[86/214] Loss: 7.4482
[129/214] Loss: 7.5187
[172/214] Loss: 7.4315
loss in epoch 73: 7.471499443054199
Epoch: 74
[0/214] Loss: 7.4628
[43/214] Loss: 7.2006
[86/214] Loss: 7.5413
[129/214] Loss: 7.2846
[172/214] Loss: 7.5894
loss in epoch 74: 7.371865272521973
Epoch: 75
[0/214] Loss: 7.1594
[43/214] Loss: 7.6004
[86/214] Loss: 7.0618
[129/214] Loss: 7.2165
[172/214] Loss: 7.2636
loss in epoch 75: 7.212129592895508
Epoch: 76
[0/214] Loss: 7.2507
[43/214] Loss: 7.3085
[86/214] Loss: 7.2815
[129/214] Loss: 7.4466
[172/214] Loss: 7.3438
loss in epoch 76: 7.374495506286621
Epoch: 77
[0/214] Loss: 7.2498
[43/214] Loss: 7.1280
[86/214] Loss: 7.2328
[129/214] Loss: 7.0022
[172/214] Loss: 7.1967
loss in epoch 77: 7.253753185272217
Epoch: 78
[0/214] Loss: 7.0761
[43/214] Loss: 7.3866
[86/214] Loss: 7.4393
[129/214] Loss: 7.0704
[172/214] Loss: 7.2498
loss in epoch 78: 6.687567234039307
Epoch: 79
[0/214] Loss: 7.0940
[43/214] Loss: 7.2162
[86/214] Loss: 7.1917
[129/214] Loss: 7.2096
[172/214] Loss: 6.9218
loss in epoch 79: 7.204753875732422
Epoch: 80
[0/214] Loss: 7.1833
[43/214] Loss: 7.3915
[86/214] Loss: 7.3044
[129/214] Loss: 7.0930
[172/214] Loss: 6.9744
loss in epoch 80: 7.287986755371094
start predicting:  2024-12-06 11:42:47.764046
Epoch: 81
[0/214] Loss: 7.0932
[43/214] Loss: 7.1495
[86/214] Loss: 6.9729
[129/214] Loss: 6.8870
[172/214] Loss: 6.7915
loss in epoch 81: 7.050001621246338
Epoch: 82
[0/214] Loss: 6.7870
[43/214] Loss: 6.8262
[86/214] Loss: 7.0852
[129/214] Loss: 6.8696
[172/214] Loss: 6.8941
loss in epoch 82: 6.8070454597473145
Epoch: 83
[0/214] Loss: 6.8052
[43/214] Loss: 6.7327
[86/214] Loss: 6.8489
[129/214] Loss: 6.9312
[172/214] Loss: 6.8499
loss in epoch 83: 6.946559429168701
Epoch: 84
[0/214] Loss: 6.7841
[43/214] Loss: 6.7138
[86/214] Loss: 6.8407
[129/214] Loss: 6.8738
[172/214] Loss: 6.7665
loss in epoch 84: 6.794854640960693
Epoch: 85
[0/214] Loss: 7.0039
[43/214] Loss: 6.6697
[86/214] Loss: 6.9845
[129/214] Loss: 6.9356
[172/214] Loss: 6.8624
loss in epoch 85: 6.913713455200195
Epoch: 86
[0/214] Loss: 6.8325
[43/214] Loss: 6.7622
[86/214] Loss: 6.9705
[129/214] Loss: 6.5255
[172/214] Loss: 7.0011
loss in epoch 86: 7.222050189971924
Epoch: 87
[0/214] Loss: 6.7806
[43/214] Loss: 6.6287
[86/214] Loss: 6.8498
[129/214] Loss: 6.6078
[172/214] Loss: 6.7895
loss in epoch 87: 6.236675262451172
Epoch: 88
[0/214] Loss: 6.6773
[43/214] Loss: 6.7442
[86/214] Loss: 6.6458
[129/214] Loss: 6.7246
[172/214] Loss: 6.7300
loss in epoch 88: 6.980419158935547
Epoch: 89
[0/214] Loss: 7.0060
[43/214] Loss: 6.7401
[86/214] Loss: 6.9095
[129/214] Loss: 6.8777
[172/214] Loss: 6.5491
loss in epoch 89: 6.693418502807617
Epoch: 90
[0/214] Loss: 6.5721
[43/214] Loss: 6.7150
[86/214] Loss: 7.1002
[129/214] Loss: 6.6708
[172/214] Loss: 6.6123
loss in epoch 90: 6.580206394195557
Epoch: 91
[0/214] Loss: 6.6967
[43/214] Loss: 6.4777
[86/214] Loss: 6.4664
[129/214] Loss: 6.2750
[172/214] Loss: 6.4095
loss in epoch 91: 6.408134937286377
Epoch: 92
[0/214] Loss: 6.3638
[43/214] Loss: 6.3515
[86/214] Loss: 6.4902
[129/214] Loss: 6.7485
[172/214] Loss: 6.3424
loss in epoch 92: 6.720120429992676
Epoch: 93
[0/214] Loss: 6.7760
[43/214] Loss: 6.4219
[86/214] Loss: 6.5658
[129/214] Loss: 6.6067
[172/214] Loss: 6.5823
loss in epoch 93: 6.398885726928711
Epoch: 94
[0/214] Loss: 6.3991
[43/214] Loss: 6.7692
[86/214] Loss: 6.4851
[129/214] Loss: 6.5903
[172/214] Loss: 6.3054
loss in epoch 94: 6.700671195983887
Epoch: 95
[0/214] Loss: 6.2505
[43/214] Loss: 6.4514
[86/214] Loss: 6.3400
[129/214] Loss: 6.3226
[172/214] Loss: 6.5571
loss in epoch 95: 6.217851161956787
Epoch: 96
[0/214] Loss: 6.5086
[43/214] Loss: 6.3009
[86/214] Loss: 6.2072
[129/214] Loss: 6.4419
[172/214] Loss: 6.5983
loss in epoch 96: 6.670900344848633
Epoch: 97
[0/214] Loss: 6.4456
[43/214] Loss: 6.4510
[86/214] Loss: 6.3243
[129/214] Loss: 6.2200
[172/214] Loss: 6.3725
loss in epoch 97: 5.675288200378418
Epoch: 98
[0/214] Loss: 6.2288
[43/214] Loss: 6.0875
[86/214] Loss: 6.1749
[129/214] Loss: 6.2465
[172/214] Loss: 6.2800
loss in epoch 98: 6.158098220825195
Epoch: 99
[0/214] Loss: 5.9309
[43/214] Loss: 6.3195
[86/214] Loss: 6.1020
[129/214] Loss: 5.9250
[172/214] Loss: 5.8809
loss in epoch 99: 5.732162952423096
Epoch: 100
[0/214] Loss: 6.2543
[43/214] Loss: 6.4965
[86/214] Loss: 6.3788
[129/214] Loss: 6.3048
[172/214] Loss: 6.1879
loss in epoch 100: 6.067148208618164
start predicting:  2024-12-06 11:51:55.715532
Epoch: 101
[0/214] Loss: 6.0744
[43/214] Loss: 6.3801
[86/214] Loss: 6.1919
[129/214] Loss: 6.1392
[172/214] Loss: 6.0752
loss in epoch 101: 6.304200649261475
Epoch: 102
[0/214] Loss: 5.9013
[43/214] Loss: 6.2439
[86/214] Loss: 6.3867
[129/214] Loss: 6.2670
[172/214] Loss: 6.2509
loss in epoch 102: 5.9900803565979
Epoch: 103
[0/214] Loss: 6.2563
[43/214] Loss: 6.1249
[86/214] Loss: 6.1868
[129/214] Loss: 6.2511
[172/214] Loss: 5.9746
loss in epoch 103: 6.095963001251221
Epoch: 104
[0/214] Loss: 6.3251
[43/214] Loss: 6.2393
[86/214] Loss: 6.2971
[129/214] Loss: 5.7938
[172/214] Loss: 5.9606
loss in epoch 104: 5.980929374694824
Epoch: 105
[0/214] Loss: 5.7064
[43/214] Loss: 5.9127
[86/214] Loss: 5.9462
[129/214] Loss: 5.8770
[172/214] Loss: 5.6623
loss in epoch 105: 5.990092754364014
Epoch: 106
[0/214] Loss: 5.7927
[43/214] Loss: 6.0300
[86/214] Loss: 6.2570
[129/214] Loss: 6.3255
[172/214] Loss: 6.1379
loss in epoch 106: 6.5517730712890625
Epoch: 107
[0/214] Loss: 5.9845
[43/214] Loss: 6.0875
[86/214] Loss: 6.1572
[129/214] Loss: 5.8053
[172/214] Loss: 5.9093
loss in epoch 107: 5.960239887237549
Epoch: 108
[0/214] Loss: 6.0407
[43/214] Loss: 6.2036
[86/214] Loss: 5.9912
[129/214] Loss: 6.1556
[172/214] Loss: 5.7645
loss in epoch 108: 6.02902889251709
Epoch: 109
[0/214] Loss: 6.5287
[43/214] Loss: 5.9952
[86/214] Loss: 5.8824
[129/214] Loss: 5.5288
[172/214] Loss: 5.9813
loss in epoch 109: 6.368727207183838
Epoch: 110
[0/214] Loss: 5.7011
[43/214] Loss: 6.0113
[86/214] Loss: 6.0107
[129/214] Loss: 6.0994
[172/214] Loss: 6.1128
loss in epoch 110: 5.7101616859436035
Epoch: 111
[0/214] Loss: 6.2612
[43/214] Loss: 6.2771
[86/214] Loss: 6.1070
[129/214] Loss: 6.0859
[172/214] Loss: 6.0327
loss in epoch 111: 5.9940948486328125
Epoch: 112
[0/214] Loss: 6.1476
[43/214] Loss: 6.1236
[86/214] Loss: 5.6495
[129/214] Loss: 5.9992
[172/214] Loss: 6.1644
loss in epoch 112: 6.083259105682373
Epoch: 113
[0/214] Loss: 6.4425
[43/214] Loss: 5.9201
[86/214] Loss: 6.2534
[129/214] Loss: 5.6933
[172/214] Loss: 6.1604
loss in epoch 113: 6.2240800857543945
Epoch: 114
[0/214] Loss: 6.1260
[43/214] Loss: 5.7586
[86/214] Loss: 6.3134
[129/214] Loss: 5.9153
[172/214] Loss: 5.9322
loss in epoch 114: 6.014562606811523
Epoch: 115
[0/214] Loss: 6.0500
[43/214] Loss: 5.9143
[86/214] Loss: 5.9207
[129/214] Loss: 6.0753
[172/214] Loss: 6.0721
loss in epoch 115: 6.134995937347412
Epoch: 116
[0/214] Loss: 5.7666
[43/214] Loss: 5.7185
[86/214] Loss: 5.7608
[129/214] Loss: 6.1891
[172/214] Loss: 5.8998
loss in epoch 116: 5.915590763092041
Epoch: 117
[0/214] Loss: 5.7337
[43/214] Loss: 5.8335
[86/214] Loss: 5.6778
[129/214] Loss: 6.2394
[172/214] Loss: 5.9738
loss in epoch 117: 5.720353126525879
Epoch: 118
[0/214] Loss: 6.0374
[43/214] Loss: 5.8885
[86/214] Loss: 6.0694
[129/214] Loss: 5.8571
[172/214] Loss: 5.8063
loss in epoch 118: 5.843535423278809
Epoch: 119
[0/214] Loss: 5.8650
[43/214] Loss: 6.1572
[86/214] Loss: 5.5940
[129/214] Loss: 6.0956
[172/214] Loss: 5.7732
loss in epoch 119: 5.757685661315918
Epoch: 120
[0/214] Loss: 6.2000
[43/214] Loss: 5.9553
[86/214] Loss: 5.6749
[129/214] Loss: 6.0672
[172/214] Loss: 5.7769
loss in epoch 120: 5.770070552825928
start predicting:  2024-12-06 12:00:59.944584
Epoch: 121
[0/214] Loss: 5.8067
[43/214] Loss: 5.9392
[86/214] Loss: 5.8910
[129/214] Loss: 5.8737
[172/214] Loss: 6.2503
loss in epoch 121: 6.15671443939209
Epoch: 122
[0/214] Loss: 5.9481
[43/214] Loss: 5.8177
[86/214] Loss: 6.0492
[129/214] Loss: 6.0160
[172/214] Loss: 6.0438
loss in epoch 122: 6.022451877593994
Epoch: 123
[0/214] Loss: 6.1373
[43/214] Loss: 5.7303
[86/214] Loss: 5.9312
[129/214] Loss: 5.9136
[172/214] Loss: 6.0015
loss in epoch 123: 6.043205261230469
Epoch: 124
[0/214] Loss: 5.8501
[43/214] Loss: 5.7532
[86/214] Loss: 5.7096
[129/214] Loss: 5.9446
[172/214] Loss: 6.0289
loss in epoch 124: 5.992676734924316
Epoch: 125
[0/214] Loss: 5.8963
[43/214] Loss: 6.0310
[86/214] Loss: 5.9892
[129/214] Loss: 5.6633
[172/214] Loss: 5.5973
loss in epoch 125: 5.913608074188232
Epoch: 126
[0/214] Loss: 6.1953
[43/214] Loss: 5.7954
[86/214] Loss: 5.7458
[129/214] Loss: 5.7919
[172/214] Loss: 5.9963
loss in epoch 126: 6.283370494842529
Epoch: 127
[0/214] Loss: 6.1072
[43/214] Loss: 5.8155
[86/214] Loss: 5.6995
[129/214] Loss: 5.7907
[172/214] Loss: 5.7244
loss in epoch 127: 5.366120338439941
Epoch: 128
[0/214] Loss: 5.8885
[43/214] Loss: 6.2495
[86/214] Loss: 5.9740
[129/214] Loss: 5.8352
[172/214] Loss: 6.3739
loss in epoch 128: 5.688172817230225
Epoch: 129
[0/214] Loss: 5.8024
[43/214] Loss: 5.8028
[86/214] Loss: 5.9078
[129/214] Loss: 6.0222
[172/214] Loss: 5.9243
loss in epoch 129: 5.81389045715332
Epoch: 130
[0/214] Loss: 6.2061
[43/214] Loss: 5.8543
[86/214] Loss: 5.9765
[129/214] Loss: 5.9031
[172/214] Loss: 5.6148
loss in epoch 130: 5.952262878417969
Epoch: 131
[0/214] Loss: 6.0309
[43/214] Loss: 5.8701
[86/214] Loss: 5.8590
[129/214] Loss: 5.4329
[172/214] Loss: 5.6905
loss in epoch 131: 6.1440043449401855
Epoch: 132
[0/214] Loss: 5.8740
[43/214] Loss: 5.8271
[86/214] Loss: 6.0166
[129/214] Loss: 5.7071
[172/214] Loss: 5.8224
loss in epoch 132: 5.82417106628418
Epoch: 133
[0/214] Loss: 5.9070
[43/214] Loss: 5.8903
[86/214] Loss: 5.7561
[129/214] Loss: 5.6612
[172/214] Loss: 5.9898
loss in epoch 133: 5.626479625701904
Epoch: 134
[0/214] Loss: 6.1706
[43/214] Loss: 5.8182
[86/214] Loss: 5.8769
[129/214] Loss: 5.7593
[172/214] Loss: 5.8327
loss in epoch 134: 5.8923773765563965
Epoch: 135
[0/214] Loss: 5.9471
[43/214] Loss: 5.6805
[86/214] Loss: 5.9475
[129/214] Loss: 5.7757
[172/214] Loss: 5.8615
loss in epoch 135: 5.692391395568848
Epoch: 136
[0/214] Loss: 5.8270
[43/214] Loss: 5.9880
[86/214] Loss: 5.6400
[129/214] Loss: 5.8105
[172/214] Loss: 5.7888
loss in epoch 136: 5.9891357421875
Epoch: 137
[0/214] Loss: 5.5635
[43/214] Loss: 5.8489
[86/214] Loss: 5.9835
[129/214] Loss: 5.9415
[172/214] Loss: 6.0319
loss in epoch 137: 5.747464656829834
Epoch: 138
[0/214] Loss: 6.1508
[43/214] Loss: 5.6855
[86/214] Loss: 5.7961
[129/214] Loss: 5.9812
[172/214] Loss: 5.8831
loss in epoch 138: 5.899223327636719
Epoch: 139
[0/214] Loss: 5.8415
[43/214] Loss: 5.8370
[86/214] Loss: 5.5457
[129/214] Loss: 5.9130
[172/214] Loss: 5.7473
loss in epoch 139: 6.105583667755127
Epoch: 140
[0/214] Loss: 5.9255
[43/214] Loss: 5.9405
[86/214] Loss: 5.9231
[129/214] Loss: 5.9748
[172/214] Loss: 5.8727
loss in epoch 140: 6.038403511047363
start predicting:  2024-12-06 12:10:03.118568
Test------------------------------------------------------
{'HR@5': 0.0257, 'NDCG@5': 0.0212, 'HR@10': 0.0411, 'NDCG@10': 0.026, 'HR@20': 0.1028, 'NDCG@20': 0.0408}
Best Eval---------------------------------------------------------
{'Best_HR@5': 0.8331, 'Best_NDCG@5': 0.5418, 'Best_HR@10': 1.2289, 'Best_NDCG@10': 0.6713, 'Best_HR@20': 1.9074, 'Best_NDCG@20': 0.8295}
{'Best_epoch_HR@5': 40, 'Best_epoch_NDCG@5': 40, 'Best_epoch_HR@10': 40, 'Best_epoch_NDCG@10': 40, 'Best_epoch_HR@20': 20, 'Best_epoch_NDCG@20': 40}
Namespace(batch_size=512, dataset='toys', decay_step=100, description='Diffu_norm_score', device='cuda', diffusion_steps=32, diversity_measure=False, dropout=0.1, emb_dropout=0.3, epoch_time_avg=False, epochs=500, eval_interval=20, gamma=0.1, hidden_act='gelu', hidden_size=128, item_num=11924, lambda_uncertainty=0.001, log_file='log/', long_head=False, loss_lambda=0.001, lr=0.001, max_len=50, metric_ks=[5, 10, 20], momentum=None, noise_schedule='trunc_lin', num_blocks=4, num_gpu=1, optimizer='Adam', patience=5, random_seed=1997, rescale_timesteps=True, schedule_sampler_name='lossaware', weight_decay=0)
